

============================== 2023-02-06 21:53:29.961334 | b3c26abc-85f5-4294-8c33-aa6198c36315 ==============================
[0m21:53:29.961334 [info ] [MainThread]: Running with dbt=1.4.1
[0m21:53:29.963136 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:53:29.966015 [debug] [MainThread]: Tracking: tracking
[0m21:53:30.004015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dfdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dfde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dfddf0>]}
[0m21:53:30.027585 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:53:30.027846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3c26abc-85f5-4294-8c33-aa6198c36315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dcfac0>]}
[0m21:53:30.403628 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m21:53:30.411252 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m21:53:30.414261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f35f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e8dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f84e50>]}
[0m21:53:30.414501 [debug] [MainThread]: Flushing usage events
[0m21:53:31.272935 [error] [MainThread]: Encountered an error:
Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  source() takes exactly two arguments (1 given)


============================== 2023-02-06 21:55:26.958115 | b02e53fb-1eb2-44f1-97e4-7f1c9adba130 ==============================
[0m21:55:26.958115 [info ] [MainThread]: Running with dbt=1.4.1
[0m21:55:26.961876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:55:26.962105 [debug] [MainThread]: Tracking: tracking
[0m21:55:26.995466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f93eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f93ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f93edf0>]}
[0m21:55:27.022872 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:55:27.023218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b02e53fb-1eb2-44f1-97e4-7f1c9adba130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f910580>]}
[0m21:55:27.412186 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m21:55:27.418670 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m21:55:27.420161 [debug] [MainThread]: 1603: static parser failed on google_analytics/total_page_views.sql
[0m21:55:27.422276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbb2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f987fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f98dee0>]}
[0m21:55:27.422466 [debug] [MainThread]: Flushing usage events
[0m21:55:28.148434 [error] [MainThread]: Encountered an error:
Compilation Error in model total_page_views (models/google_analytics/total_page_views.sql)
  source() takes exactly two arguments (1 given)


============================== 2023-02-06 21:56:08.715467 | b354fbf1-afd5-46df-ba3b-86fcf6d81c42 ==============================
[0m21:56:08.715467 [info ] [MainThread]: Running with dbt=1.4.1
[0m21:56:08.717858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:56:08.718013 [debug] [MainThread]: Tracking: tracking
[0m21:56:08.781506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460d1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460d1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460d1d00>]}
[0m21:56:08.812265 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:56:08.812815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b354fbf1-afd5-46df-ba3b-86fcf6d81c42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146094430>]}
[0m21:56:09.387285 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m21:56:09.394384 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m21:56:09.395924 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m21:56:09.417502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146277f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14629e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462bba30>]}
[0m21:56:09.417728 [debug] [MainThread]: Flushing usage events
[0m21:56:10.231170 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/google_analytics/sources.yml @ sources: {'name': 'ga_sample', 'type': 'bigquery', 'database': 'bigquery-public-data', 'schema': 'google_analytics_sample', 'table': 'ga_sessions_*'} - at path []: Additional properties are not allowed ('type', 'table' were unexpected)


============================== 2023-02-06 21:56:59.965477 | c0eb4569-6378-437f-b026-1296185e3636 ==============================
[0m21:56:59.965477 [info ] [MainThread]: Running with dbt=1.4.1
[0m21:56:59.968086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:56:59.968212 [debug] [MainThread]: Tracking: tracking
[0m21:56:59.987754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cfaa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cfadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cfad30>]}
[0m21:57:00.008216 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:57:00.008542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0eb4569-6378-437f-b026-1296185e3636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cc0100>]}
[0m21:57:00.421923 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m21:57:00.429171 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m21:57:00.431177 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m21:57:00.452715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d8e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f943a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f94370>]}
[0m21:57:00.453075 [debug] [MainThread]: Flushing usage events
[0m21:57:01.218816 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.google_analytics_dbt.distinct_country_count' (models/google_analytics/distinct_country_count.sql) depends on a source named 'ga_sample.bigquery-public-data' which was not found


============================== 2023-02-06 22:07:07.097145 | 9a10ac1f-cd71-496f-99bf-a1b08c52dc76 ==============================
[0m22:07:07.097145 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:07:07.100948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:07:07.101074 [debug] [MainThread]: Tracking: tracking
[0m22:07:07.217413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151304a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151304dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151304d30>]}
[0m22:07:07.239764 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:07:07.247636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a10ac1f-cd71-496f-99bf-a1b08c52dc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1512c0100>]}
[0m22:07:07.595000 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m22:07:07.601238 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m22:07:07.602677 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m22:07:07.619601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15134a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1514933a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151493370>]}
[0m22:07:07.619819 [debug] [MainThread]: Flushing usage events
[0m22:07:08.585345 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.google_analytics_dbt.distinct_country_count' (models/google_analytics/distinct_country_count.sql) depends on a source named 'bigquery-public-data.ga_sessions_*' which was not found


============================== 2023-02-06 22:12:16.864652 | 71f09aa1-8d78-49c7-adb9-b99da241e442 ==============================
[0m22:12:16.864652 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:12:16.866904 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:12:16.867096 [debug] [MainThread]: Tracking: tracking
[0m22:12:16.916601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508fda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508fde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508fdd90>]}
[0m22:12:16.947764 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:12:16.948020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71f09aa1-8d78-49c7-adb9-b99da241e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508baca0>]}
[0m22:12:17.345009 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m22:12:17.351918 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m22:12:17.354359 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m22:12:17.378881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150a864f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150be8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150be83d0>]}
[0m22:12:17.379121 [debug] [MainThread]: Flushing usage events
[0m22:12:18.159850 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.google_analytics_dbt.distinct_country_count' (models/google_analytics/distinct_country_count.sql) depends on a source named 'bigquery-public-data.ga_sessions_*' which was not found


============================== 2023-02-06 22:13:09.356074 | 2cd61eb2-04b4-4525-8aeb-c9475e2697d9 ==============================
[0m22:13:09.356074 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:13:09.360412 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:13:09.360595 [debug] [MainThread]: Tracking: tracking
[0m22:13:09.375924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601bca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601bcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601bcd30>]}
[0m22:13:09.397210 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:13:09.397722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160180100>]}
[0m22:13:09.797173 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m22:13:09.805159 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m22:13:09.806691 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m22:13:09.844373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m22:13:09.847944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16025e940>]}
[0m22:13:09.856350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160487fa0>]}
[0m22:13:09.856691 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:13:09.856866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160463f40>]}
[0m22:13:09.857797 [info ] [MainThread]: 
[0m22:13:09.858816 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:13:09.861585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m22:13:09.861846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:12.807051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m22:13:12.807580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:13.368861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16025e550>]}
[0m22:13:13.373533 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m22:13:13.374209 [info ] [MainThread]: 
[0m22:13:13.386945 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m22:13:13.387134 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m22:13:13.387428 [info ] [Thread-1  ]: 1 of 3 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m22:13:13.387597 [info ] [Thread-2  ]: 2 of 3 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m22:13:13.389373 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m22:13:13.389799 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m22:13:13.390278 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m22:13:13.390413 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m22:13:13.395569 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m22:13:13.398982 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m22:13:13.400944 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 22:13:13.390532 => 2023-02-06 22:13:13.400825
[0m22:13:13.401037 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 22:13:13.395771 => 2023-02-06 22:13:13.401013
[0m22:13:13.401175 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m22:13:13.401304 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m22:13:13.412593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:13:13.415849 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:13:13.957553 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m22:13:13.958389 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m22:13:13.961550 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m22:13:13.962224 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m22:13:28.801271 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:5b77f0dd-a99b-4b0e-b784-5fafb8c231b2&page=queryresults
[0m22:13:28.829588 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 22:13:13.412900 => 2023-02-06 22:13:28.829447
[0m22:13:28.832306 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160530310>]}
[0m22:13:28.832971 [info ] [Thread-2  ]: 2 of 3 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.44s]
[0m22:13:28.841446 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m22:13:30.740071 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:edc0f1f7-0c78-40ef-96b2-4fd12af7a9c0&page=queryresults
[0m22:13:30.741858 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-06 22:13:13.401380 => 2023-02-06 22:13:30.741823
[0m22:13:30.742392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602dc400>]}
[0m22:13:30.742600 [info ] [Thread-1  ]: 1 of 3 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 17.35s]
[0m22:13:30.742767 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m22:13:30.744155 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m22:13:30.744427 [info ] [Thread-3  ]: 3 of 3 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m22:13:30.744818 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m22:13:30.744969 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m22:13:30.748591 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m22:13:30.752406 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-06 22:13:30.745059 => 2023-02-06 22:13:30.752371
[0m22:13:30.752530 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m22:13:30.765619 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m22:13:30.766078 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:13:30.766344 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m22:13:32.104871 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:49a1a079-0f7b-4233-9c1e-a1fa1d025ab7&page=queryresults
[0m22:13:32.194711 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-06 22:13:30.752611 => 2023-02-06 22:13:32.194077
[0m22:13:32.203580 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd61eb2-04b4-4525-8aeb-c9475e2697d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602dc2e0>]}
[0m22:13:32.216092 [info ] [Thread-3  ]: 3 of 3 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m22:13:32.216471 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m22:13:32.220108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:13:32.221058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:32.221157 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m22:13:32.221229 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m22:13:32.221295 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m22:13:32.221699 [info ] [MainThread]: 
[0m22:13:32.221890 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 22.36 seconds (22.36s).
[0m22:13:32.224439 [debug] [MainThread]: Command end result
[0m22:13:32.237561 [info ] [MainThread]: 
[0m22:13:32.239682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:32.239836 [info ] [MainThread]: 
[0m22:13:32.241205 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:13:32.242912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16020e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160239a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602397c0>]}
[0m22:13:32.243066 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 23:02:38.058418 | 72a6870b-116e-4c4a-bb44-31ec476d8ce5 ==============================
[0m23:02:38.058418 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:02:38.060121 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:02:38.060267 [debug] [MainThread]: Tracking: tracking
[0m23:02:38.074127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132145ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132145e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132145dc0>]}
[0m23:02:38.103697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:38.104072 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m23:02:38.111685 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m23:02:38.118928 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/distinct_country_count.sql
[0m23:02:38.125976 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:02:38.129079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323736a0>]}
[0m23:02:38.132808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321587f0>]}
[0m23:02:38.133007 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:02:38.133144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322c49d0>]}
[0m23:02:38.133784 [info ] [MainThread]: 
[0m23:02:38.134579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:02:38.135143 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:02:38.135303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:52.997573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:03:52.999154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:53.463154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131fc2d60>]}
[0m23:03:53.464945 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:03:53.465509 [info ] [MainThread]: 
[0m23:03:53.472034 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:03:53.472450 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:03:53.473215 [info ] [Thread-1  ]: 1 of 3 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:03:53.473778 [info ] [Thread-2  ]: 2 of 3 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:03:53.474704 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:03:53.475416 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:03:53.475674 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:03:53.475942 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:03:53.485441 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:03:53.486650 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:03:53.476144 => 2023-02-06 23:03:53.486550
[0m23:03:53.487960 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:03:53.481990 => 2023-02-06 23:03:53.487909
[0m23:03:53.488281 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:03:53.505826 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:03:53.510476 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'logging' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:03:53.510804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322e6040>]}
[0m23:03:53.511120 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.04s]
[0m23:03:53.512317 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:03:54.035603 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:03:54.036402 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:04:11.240573 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:0038c1f4-5f03-434d-bb17-70f86e36f9d6&page=queryresults
[0m23:04:11.271438 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:03:53.488558 => 2023-02-06 23:04:11.271216
[0m23:04:11.272522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a6870b-116e-4c4a-bb44-31ec476d8ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13243e760>]}
[0m23:04:11.273383 [info ] [Thread-2  ]: 2 of 3 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 17.80s]
[0m23:04:11.273793 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:04:11.275092 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m23:04:11.275442 [info ] [Thread-3  ]: 3 of 3 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:04:11.275756 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:04:11.277100 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:04:11.277702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:11.277869 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m23:04:11.278017 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:04:11.278232 [info ] [MainThread]: 
[0m23:04:11.278581 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 1 minutes and 33.14 seconds (93.14s).
[0m23:04:11.279091 [debug] [MainThread]: Command end result
[0m23:04:11.287145 [info ] [MainThread]: 
[0m23:04:11.287417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:04:11.287605 [info ] [MainThread]: 
[0m23:04:11.287797 [error] [MainThread]: [33mCompilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)[0m
[0m23:04:11.287980 [error] [MainThread]:   'logging' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:04:11.288149 [info ] [MainThread]: 
[0m23:04:11.288324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m23:04:11.288623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132438e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132438670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323255e0>]}
[0m23:04:11.288839 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 23:14:09.195019 | 4ef37eb8-eb01-4bf2-9ea6-880377269fec ==============================
[0m23:14:09.195019 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:14:09.195902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:14:09.196010 [debug] [MainThread]: Tracking: tracking
[0m23:14:09.208815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baef70>]}
[0m23:14:09.210426 [debug] [MainThread]: Set downloads directory='/var/folders/97/x0h1qbhn57s64gs1tznyvcs40000gn/T/dbt-downloads-5te6rbhz'
[0m23:14:09.211023 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:14:09.624352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:14:09.625145 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json
[0m23:14:10.044145 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json 200
[0m23:14:10.055605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:14:10.783905 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:14:10.849473 [info ] [MainThread]: Installing dbt-labs/logging
[0m23:14:12.132115 [info ] [MainThread]:   Installed from version 0.8.0
[0m23:14:12.132579 [info ] [MainThread]:   Up to date!
[0m23:14:12.132955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ef37eb8-eb01-4bf2-9ea6-880377269fec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bae100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f610>]}
[0m23:14:12.133270 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:14:12.798654 [info ] [MainThread]:   Installed from version 1.0.0
[0m23:14:12.798983 [info ] [MainThread]:   Up to date!
[0m23:14:12.799203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ef37eb8-eb01-4bf2-9ea6-880377269fec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c79d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f610>]}
[0m23:14:12.799859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c49f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f6a0>]}
[0m23:14:12.800047 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 23:14:18.120622 | 9f8bf8f4-5010-4894-945a-a751588a11ed ==============================
[0m23:14:18.120622 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:14:18.121970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:14:18.122107 [debug] [MainThread]: Tracking: tracking
[0m23:14:18.130512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120599100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120569f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120569a30>]}
[0m23:14:18.151725 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m23:14:18.151999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d11c0>]}
[0m23:14:18.632643 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m23:14:18.638457 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m23:14:18.641226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/distinct_country_count.sql
[0m23:14:18.641847 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m23:14:18.655005 [debug] [MainThread]: 1603: static parser failed on stg_dbt_audit_log.sql
[0m23:14:18.667561 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_dbt_audit_log.sql
[0m23:14:18.668220 [debug] [MainThread]: 1603: static parser failed on default/stg_dbt_deployments.sql
[0m23:14:18.672129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on default/stg_dbt_deployments.sql
[0m23:14:18.672774 [debug] [MainThread]: 1603: static parser failed on default/stg_dbt_model_deployments.sql
[0m23:14:18.676112 [debug] [MainThread]: 1602: parser fallback to jinja rendering on default/stg_dbt_model_deployments.sql
[0m23:14:18.676738 [debug] [MainThread]: 1603: static parser failed on bigquery/stg_dbt_deployments.sql
[0m23:14:18.679704 [debug] [MainThread]: 1602: parser fallback to jinja rendering on bigquery/stg_dbt_deployments.sql
[0m23:14:18.680342 [debug] [MainThread]: 1603: static parser failed on bigquery/stg_dbt_model_deployments.sql
[0m23:14:18.683628 [debug] [MainThread]: 1602: parser fallback to jinja rendering on bigquery/stg_dbt_model_deployments.sql
[0m23:14:18.760480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:14:18.763442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12126d5b0>]}
[0m23:14:18.771449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210784c0>]}
[0m23:14:18.771658 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:14:18.771810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12114dbb0>]}
[0m23:14:18.772694 [info ] [MainThread]: 
[0m23:14:18.773530 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:14:18.774357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:14:18.774538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:18.774805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:14:18.775042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:20.457262 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_wo-dev-376902_google_analytics_sample_meta'
[0m23:14:20.459078 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_wo-dev-376902_google_analytics_sample_meta'
[0m23:14:20.459899 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='wo-dev-376902', schema='google_analytics_sample_meta', identifier=None)"
[0m23:14:20.464891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:20.465767 [debug] [ThreadPool]: On create_wo-dev-376902_google_analytics_sample_meta: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "create_wo-dev-376902_google_analytics_sample_meta"} */
create schema if not exists `wo-dev-376902`.`google_analytics_sample_meta`
  
[0m23:14:23.851690 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:3551b3c8-3e73-4150-a549-76860afe6574&page=queryresults
[0m23:14:23.856454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:14:23.857413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:14:23.857866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:23.858234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:25.482972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211da040>]}
[0m23:14:25.483880 [info ] [MainThread]: 
[0m23:14:25.484362 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:14:25.489744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:26.345253 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:14:26.350492 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:14:26.351397 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:14:26.361166 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:14:26.362280 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:14:26.362727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`
        (
        
            event_name STRING,
        
            event_timestamp TIMESTAMP,
        
            event_schema STRING,
        
            event_model STRING,
        
            event_target STRING,
        
            event_is_full_refresh BOOLEAN,
        
            invocation_id STRING
        
        )
[0m23:14:27.610229 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:7ef10e3f-a83c-4e6c-b3e3-e1b2d2ca51cb&page=queryresults
[0m23:14:27.611522 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mNone (0 processed)[0m in 1.25s]
[0m23:14:27.620314 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:14:27.621498 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:14:27.621948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '9f8bf8f4-5010-4894-945a-a751588a11ed'
    );



[0m23:14:28.007669 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:9b4c8bc0-41fc-408e-9915-7b10a3dd4104&page=queryresults
[0m23:14:28.008807 [info ] [MainThread]: Database error while running on-run-start
[0m23:14:28.010280 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:14:28.010790 [info ] [MainThread]: 
[0m23:14:28.024141 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:14:28.024473 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:14:28.024739 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:14:28.025137 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:14:28.025553 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:14:28.025969 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:14:28.026735 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:14:28.027281 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:14:28.027903 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:14:28.028162 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:14:28.028404 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:14:28.028636 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:14:28.039909 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:14:28.045694 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:14:28.046326 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:14:28.028811 => 2023-02-06 23:14:28.046249
[0m23:14:28.047742 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:14:28.040149 => 2023-02-06 23:14:28.047662
[0m23:14:28.048340 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:14:28.048774 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:14:28.036841 => 2023-02-06 23:14:28.048722
[0m23:14:28.067358 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:14:28.071046 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:14:28.078885 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:14:28.079988 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:14:28.080169 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:14:28.082517 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:14:28.082724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121310b50>]}
[0m23:14:28.082947 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.06s]
[0m23:14:28.083768 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:14:29.125720 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:14:29.128412 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:14:29.979014 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2dd0f27c-cedc-4fd0-b88c-f713e6b7683d&page=queryresults
[0m23:14:30.002693 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:14:28.048950 => 2023-02-06 23:14:30.002620
[0m23:14:30.003613 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12131f5e0>]}
[0m23:14:30.004116 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m23:14:30.004498 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:14:30.005063 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:14:30.005382 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:14:30.005759 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:14:30.006101 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:14:30.006706 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:14:30.007194 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:14:30.007406 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:14:30.007610 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:14:30.011791 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:14:30.017520 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:14:30.018212 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:14:30.007750 => 2023-02-06 23:14:30.018165
[0m23:14:30.018387 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:14:30.011976 => 2023-02-06 23:14:30.018349
[0m23:14:30.018556 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:14:30.018735 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:14:30.021723 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:14:30.024585 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:14:30.025045 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:14:30.025221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:14:30.025443 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:14:30.025632 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:14:31.794839 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:083a224f-f392-416c-9e33-79755ea9f0c0&page=queryresults
[0m23:14:31.796631 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c3fb15d2-e94d-4936-b812-2f01d25ab458&page=queryresults
[0m23:14:31.800166 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:14:30.021876 => 2023-02-06 23:14:31.800059
[0m23:14:31.802399 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:14:30.018863 => 2023-02-06 23:14:31.802345
[0m23:14:31.803375 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12132ea60>]}
[0m23:14:31.804207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12131f250>]}
[0m23:14:31.804786 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m23:14:31.805434 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m23:14:31.805897 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:14:31.806222 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:14:49.175556 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:763ddc4f-00c7-4909-be52-d1be279424a2&page=queryresults
[0m23:14:49.186702 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:14:28.071245 => 2023-02-06 23:14:49.186614
[0m23:14:49.187782 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8bf8f4-5010-4894-945a-a751588a11ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213494c0>]}
[0m23:14:49.188379 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 21.16s]
[0m23:14:49.188844 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:14:49.189739 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m23:14:49.190190 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:14:49.190656 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:14:49.191731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:49.191979 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:14:49.192187 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:14:49.192382 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:14:49.192677 [info ] [MainThread]: 
[0m23:14:49.192986 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 30.42 seconds (30.42s).
[0m23:14:49.193448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12135de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121373c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121373bb0>]}
[0m23:14:49.193715 [debug] [MainThread]: Flushing usage events
[0m23:14:54.542788 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:14:54.548402 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-06 23:25:45.659952 | fe318a19-f6fc-47dd-998c-3df945f528ac ==============================
[0m23:25:45.659952 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:25:45.661406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:25:45.661508 [debug] [MainThread]: Tracking: tracking
[0m23:25:45.693862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115aed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115aef70>]}
[0m23:25:45.697806 [debug] [MainThread]: Set downloads directory='/var/folders/97/x0h1qbhn57s64gs1tznyvcs40000gn/T/dbt-downloads-gz0pjx6u'
[0m23:25:45.698580 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:25:46.036290 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:25:46.036943 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json
[0m23:25:46.300645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/logging.json 200
[0m23:25:46.304084 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:25:46.551698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:25:46.585873 [info ] [MainThread]: Installing dbt-labs/logging
[0m23:25:47.685545 [info ] [MainThread]:   Installed from version 0.8.0
[0m23:25:47.685803 [info ] [MainThread]:   Up to date!
[0m23:25:47.685987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe318a19-f6fc-47dd-998c-3df945f528ac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164f640>]}
[0m23:25:47.686138 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:25:48.457952 [info ] [MainThread]:   Installed from version 1.0.0
[0m23:25:48.458319 [info ] [MainThread]:   Up to date!
[0m23:25:48.458558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe318a19-f6fc-47dd-998c-3df945f528ac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115aeb20>]}
[0m23:25:48.461031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111649f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ae0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ae0a0>]}
[0m23:25:48.461329 [debug] [MainThread]: Flushing usage events


============================== 2023-02-06 23:25:55.077361 | 6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09 ==============================
[0m23:25:55.077361 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:25:55.079045 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:25:55.079283 [debug] [MainThread]: Tracking: tracking
[0m23:25:55.096566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144106a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440f8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440f8a90>]}
[0m23:25:55.179196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:25:55.179599 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m23:25:55.197189 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m23:25:55.210098 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/distinct_country_count.sql
[0m23:25:55.222538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:25:55.225848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14448a0d0>]}
[0m23:25:55.238113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443f7fa0>]}
[0m23:25:55.238486 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:25:55.238638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443cf7f0>]}
[0m23:25:55.239646 [info ] [MainThread]: 
[0m23:25:55.240628 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:25:55.241429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:25:55.241748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:25:55.241922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:55.242054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:58.090994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:25:58.091449 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:25:58.091638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:58.091763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:58.653099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443f7d30>]}
[0m23:25:58.654576 [info ] [MainThread]: 
[0m23:25:58.654750 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:25:58.681371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:59.163762 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:25:59.173897 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:25:59.175631 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:25:59.568228 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:25:59.568584 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:25:59.568778 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m23:25:59.576008 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:25:59.578115 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:25:59.578438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09'
    );



[0m23:26:00.080676 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:6779d8a6-e4bf-4dd5-b124-011581c636eb&page=queryresults
[0m23:26:00.081110 [info ] [MainThread]: Database error while running on-run-start
[0m23:26:00.081731 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:26:00.081948 [info ] [MainThread]: 
[0m23:26:00.092318 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:26:00.092514 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:26:00.092643 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:26:00.093659 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:26:00.093912 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:26:00.094097 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:26:00.094580 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:26:00.094882 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:26:00.095151 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:26:00.095290 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:26:00.095399 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:26:00.095501 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:26:00.100148 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:26:00.110572 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:26:00.112593 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:26:00.095588 => 2023-02-06 23:26:00.112485
[0m23:26:00.114655 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:26:00.100344 => 2023-02-06 23:26:00.114609
[0m23:26:00.114863 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:26:00.127162 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:26:00.098234 => 2023-02-06 23:26:00.127085
[0m23:26:00.137065 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:26:00.137333 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:26:00.145352 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:26:00.145601 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:26:00.146204 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:26:00.155566 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:26:00.155917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444defd0>]}
[0m23:26:00.156310 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.06s]
[0m23:26:00.157226 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:26:00.649758 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:26:00.650303 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:26:01.635699 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:caee03d6-f509-498f-afcc-a13e22959f7c&page=queryresults
[0m23:26:01.647991 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:26:00.114943 => 2023-02-06 23:26:01.647923
[0m23:26:01.648628 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445f30a0>]}
[0m23:26:01.649005 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m23:26:01.650003 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:26:01.650778 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:26:01.650903 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:26:01.651062 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:26:01.651246 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:26:01.651561 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:26:01.651823 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:26:01.651934 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:26:01.652050 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:26:01.657239 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:26:01.663365 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:26:01.663755 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:26:01.652130 => 2023-02-06 23:26:01.663708
[0m23:26:01.663947 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:26:01.667552 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:26:01.667736 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:26:01.657364 => 2023-02-06 23:26:01.667697
[0m23:26:01.667952 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:26:01.669877 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:26:01.670164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:01.670360 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:26:01.670451 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:26:01.671168 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:26:02.886933 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:502e3fa8-ab94-4843-bd21-257e427ac85b&page=queryresults
[0m23:26:02.888457 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:26:01.664037 => 2023-02-06 23:26:02.888420
[0m23:26:02.888857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1446a93d0>]}
[0m23:26:02.889102 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m23:26:02.889597 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2dae3ede-422f-4ba3-a67f-b76102cc6d75&page=queryresults
[0m23:26:02.889739 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:26:02.890549 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:26:01.668039 => 2023-02-06 23:26:02.890531
[0m23:26:02.890918 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444dec70>]}
[0m23:26:02.891082 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m23:26:02.891223 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:26:17.803593 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:f4f82db9-94de-40b9-88a5-15f129b607e2&page=queryresults
[0m23:26:17.820519 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:26:00.137498 => 2023-02-06 23:26:17.820392
[0m23:26:17.821975 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e3ab5-571d-4cf7-9a1d-8f168a96cb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444d7b20>]}
[0m23:26:17.824893 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 17.73s]
[0m23:26:17.825191 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:26:17.837689 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.users_report
[0m23:26:17.838679 [info ] [Thread-1  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:26:17.838868 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:26:17.847177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:17.847935 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:26:17.848008 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:26:17.848074 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:26:17.848871 [info ] [MainThread]: 
[0m23:26:17.850753 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 22.61 seconds (22.61s).
[0m23:26:17.858219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14459d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444eb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444eb460>]}
[0m23:26:17.858417 [debug] [MainThread]: Flushing usage events
[0m23:26:18.695309 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:26:18.795715 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-06 23:30:49.561947 | 73135899-7c75-45b4-9f60-35fb5af2cdaa ==============================
[0m23:30:49.561947 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:30:49.564753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:30:49.564969 [debug] [MainThread]: Tracking: tracking
[0m23:30:49.599288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158605a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585f7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585f7bb0>]}
[0m23:30:49.665973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:49.666187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:49.667476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:30:49.673177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158930fa0>]}
[0m23:30:49.683226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158822940>]}
[0m23:30:49.683566 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:30:49.683834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158822b50>]}
[0m23:30:49.685082 [info ] [MainThread]: 
[0m23:30:49.686057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:30:49.689781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:30:49.690423 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:30:49.690638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:49.690854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:52.990228 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:30:52.990832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:30:52.992068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:52.992243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:53.409701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a33880>]}
[0m23:30:53.413765 [info ] [MainThread]: 
[0m23:30:53.414682 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:30:53.436012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:54.021233 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:30:54.037003 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:30:54.037483 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:30:54.397190 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:30:54.398069 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:30:54.398301 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m23:30:54.407024 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:30:54.407540 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:30:54.407885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '73135899-7c75-45b4-9f60-35fb5af2cdaa'
    );



[0m23:30:54.744010 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:fc6d1b68-99c4-4042-972c-874d8eadffc1&page=queryresults
[0m23:30:54.744330 [info ] [MainThread]: Database error while running on-run-start
[0m23:30:54.744999 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:30:54.745123 [info ] [MainThread]: 
[0m23:30:54.796432 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:30:54.796643 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:30:54.796766 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:30:54.797029 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:30:54.797239 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:30:54.797484 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:30:54.797886 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:30:54.798178 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:30:54.798448 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:30:54.798585 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:30:54.798700 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:30:54.798817 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:30:54.814017 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:30:54.824675 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:30:54.798917 => 2023-02-06 23:30:54.824601
[0m23:30:54.828444 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:30:54.828685 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:30:54.811345 => 2023-02-06 23:30:54.828657
[0m23:30:54.828809 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:30:54.840485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:54.841764 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:30:54.816100 => 2023-02-06 23:30:54.841687
[0m23:30:54.842299 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:30:54.860098 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:30:54.860960 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:30:54.861131 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:30:54.868673 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:30:54.869060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589850a0>]}
[0m23:30:54.869355 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.07s]
[0m23:30:54.872073 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:30:55.510267 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:30:55.511782 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:30:56.338591 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:e2ec9cb7-381b-4e1c-821f-94b71388fdc9&page=queryresults
[0m23:30:56.347282 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:30:54.842442 => 2023-02-06 23:30:56.347250
[0m23:30:56.347646 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a990d0>]}
[0m23:30:56.347858 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m23:30:56.348022 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:30:56.348262 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:30:56.348509 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:30:56.348400 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:30:56.348942 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:30:56.349047 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:30:56.352317 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:30:56.348651 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:30:56.354073 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:30:56.354187 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:30:56.356827 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:30:56.357094 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:30:56.349116 => 2023-02-06 23:30:56.357066
[0m23:30:56.357206 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:30:56.358826 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:30:56.358987 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:30:56.354256 => 2023-02-06 23:30:56.358965
[0m23:30:56.359087 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:30:56.360648 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:30:56.360896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:56.361060 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:30:56.361630 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:56.361800 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:30:57.543380 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:bddc183b-95ce-4c0c-b631-ab2215393907&page=queryresults
[0m23:30:57.544415 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:30:56.359151 => 2023-02-06 23:30:57.544386
[0m23:30:57.544746 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15891fc70>]}
[0m23:30:57.544952 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m23:30:57.545115 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:30:57.626576 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2cffd9c9-773f-43e8-bb86-f6ab8d6f7989&page=queryresults
[0m23:30:57.627647 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:30:56.357273 => 2023-02-06 23:30:57.627619
[0m23:30:57.627976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158947070>]}
[0m23:30:57.628168 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m23:30:57.628340 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:31:12.707729 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:293a904a-f37c-4ae4-8447-cea56609527b&page=queryresults
[0m23:31:12.729968 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:30:54.828882 => 2023-02-06 23:31:12.729797
[0m23:31:12.735053 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73135899-7c75-45b4-9f60-35fb5af2cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158989070>]}
[0m23:31:12.738957 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 17.94s]
[0m23:31:12.739554 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:31:12.745281 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m23:31:12.747527 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:31:12.747950 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:31:12.749118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:12.749278 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:31:12.749368 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:31:12.749440 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:31:12.750662 [info ] [MainThread]: 
[0m23:31:12.753696 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 23.06 seconds (23.06s).
[0m23:31:12.756526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158990fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589c53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158988070>]}
[0m23:31:12.757793 [debug] [MainThread]: Flushing usage events
[0m23:31:13.520249 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:31:13.527831 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-06 23:33:02.426368 | ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce ==============================
[0m23:33:02.426368 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:33:02.434876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:33:02.435163 [debug] [MainThread]: Tracking: tracking
[0m23:33:02.471648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ad8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144aa9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144aa9220>]}
[0m23:33:02.613822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:02.614243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:02.614890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:33:02.618660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cf1f40>]}
[0m23:33:02.625003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144be2af0>]}
[0m23:33:02.625329 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:33:02.625493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ac6c40>]}
[0m23:33:02.626588 [info ] [MainThread]: 
[0m23:33:02.627624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:33:02.631616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:33:02.632051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:33:02.632258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:02.632414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:05.378416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:33:05.380493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:33:05.381224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:05.381373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:06.092309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144cdf760>]}
[0m23:33:06.093420 [info ] [MainThread]: 
[0m23:33:06.093674 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:33:06.137145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:06.673987 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:33:06.689275 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:33:06.689697 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:33:07.289494 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:33:07.291469 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:33:07.291662 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m23:33:07.324611 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:33:07.325176 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:33:07.340043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce'
    );



[0m23:33:07.905262 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:dd8d1da7-0efd-4f72-a39e-3cfab07240ef&page=queryresults
[0m23:33:07.910861 [info ] [MainThread]: Database error while running on-run-start
[0m23:33:07.913080 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:33:07.913325 [info ] [MainThread]: 
[0m23:33:08.050322 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:33:08.050551 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:33:08.050672 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:33:08.053343 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:33:08.053635 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:33:08.053821 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:33:08.054193 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:33:08.054569 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:33:08.054857 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:33:08.054994 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:33:08.055107 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:33:08.055206 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:33:08.078179 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:33:08.086786 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:33:08.088429 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:33:08.055297 => 2023-02-06 23:33:08.088311
[0m23:33:08.094255 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:33:08.078370 => 2023-02-06 23:33:08.094187
[0m23:33:08.094471 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:33:08.116497 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:33:08.116732 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:33:08.076271 => 2023-02-06 23:33:08.116690
[0m23:33:08.116966 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:33:08.124156 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:33:08.124671 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:33:08.125087 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:33:08.145757 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:33:08.146091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144db5220>]}
[0m23:33:08.146349 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.09s]
[0m23:33:08.147152 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:33:08.626464 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:33:08.626947 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:33:09.388864 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:fe1e375e-6d15-4f8d-a28e-caf13d0c3106&page=queryresults
[0m23:33:09.427673 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:33:08.094558 => 2023-02-06 23:33:09.427624
[0m23:33:09.429003 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d51040>]}
[0m23:33:09.429350 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m23:33:09.429601 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:33:09.430000 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:33:09.430153 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:33:09.430321 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:33:09.430606 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:33:09.430748 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:33:09.430932 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:33:09.431191 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:33:09.440519 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:33:09.440772 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:33:09.444009 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:33:09.445641 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:33:09.440949 => 2023-02-06 23:33:09.445585
[0m23:33:09.447339 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:33:09.450026 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:33:09.450204 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:33:09.431274 => 2023-02-06 23:33:09.450168
[0m23:33:09.450369 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:33:09.452288 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:33:09.452514 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:33:09.453628 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:33:09.454126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:33:09.454516 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:33:10.726344 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4a70ebe9-44ce-4e7f-abbf-515c32a8455b&page=queryresults
[0m23:33:10.728847 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:266856eb-1b94-4e14-87af-815102b9608b&page=queryresults
[0m23:33:10.738129 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:33:09.447445 => 2023-02-06 23:33:10.737946
[0m23:33:10.739618 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:33:09.450464 => 2023-02-06 23:33:10.739598
[0m23:33:10.746327 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ad84f0>]}
[0m23:33:10.746865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d42eb0>]}
[0m23:33:10.748301 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m23:33:10.748574 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m23:33:10.748956 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:33:10.749111 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:33:23.367640 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:90883e90-e759-4ec9-990e-e7d0b7d11f23&page=queryresults
[0m23:33:23.392915 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:33:08.117071 => 2023-02-06 23:33:23.392797
[0m23:33:23.398610 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae320e76-d5d7-48fc-bdfe-6c2b8c5d33ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d49fa0>]}
[0m23:33:23.401312 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.34s]
[0m23:33:23.403277 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:33:23.420312 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m23:33:23.427001 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:33:23.427970 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:33:23.439759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:23.440865 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:33:23.440975 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:33:23.441050 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:33:23.441261 [info ] [MainThread]: 
[0m23:33:23.442810 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 20.81 seconds (20.81s).
[0m23:33:23.446284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14581fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d47fd0>]}
[0m23:33:23.447228 [debug] [MainThread]: Flushing usage events
[0m23:33:24.166234 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:33:24.170496 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-06 23:35:13.175857 | 9d7deed6-850d-4709-b1e5-6a6e08381f18 ==============================
[0m23:35:13.175857 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:35:13.293369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:35:13.293653 [debug] [MainThread]: Tracking: tracking
[0m23:35:13.319686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb18130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8d1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8d1730>]}
[0m23:35:13.404761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:13.414368 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m23:35:13.423345 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m23:35:13.433825 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/distinct_country_count.sql
[0m23:35:13.453560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:35:13.457807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eebb0d0>]}
[0m23:35:13.464336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb35130>]}
[0m23:35:13.464711 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:35:13.464905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb06c40>]}
[0m23:35:13.467844 [info ] [MainThread]: 
[0m23:35:13.469358 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:35:13.470471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:35:13.470878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:35:13.471030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:13.471206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:17.163412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:35:17.164514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:35:17.164748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:17.164879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:17.634435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eb350a0>]}
[0m23:35:17.640028 [info ] [MainThread]: 
[0m23:35:17.640364 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:35:17.716621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:18.509947 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:35:18.520046 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:35:18.522001 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:35:18.976754 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:35:18.977136 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:35:18.977331 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m23:35:18.989265 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:35:18.989748 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:35:18.991229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '9d7deed6-850d-4709-b1e5-6a6e08381f18'
    );



[0m23:35:19.502077 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:918bd513-44d1-4ebf-a463-2ea3934045d1&page=queryresults
[0m23:35:19.502874 [info ] [MainThread]: Database error while running on-run-start
[0m23:35:19.506806 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:35:19.507369 [info ] [MainThread]: 
[0m23:35:19.546917 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:35:19.547142 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:35:19.547371 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:35:19.547607 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:35:19.547799 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:35:19.547993 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:35:19.548519 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:35:19.548820 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:35:19.549087 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:35:19.549219 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:35:19.549323 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:35:19.549450 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:35:19.556452 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:35:19.570555 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:35:19.572512 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:35:19.549578 => 2023-02-06 23:35:19.572391
[0m23:35:19.573034 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:35:19.552841 => 2023-02-06 23:35:19.573002
[0m23:35:19.574044 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:35:19.583791 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:35:19.585027 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:35:19.557888 => 2023-02-06 23:35:19.584974
[0m23:35:19.585302 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:35:19.604569 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:35:19.606164 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:35:19.606662 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:35:19.615455 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:35:19.616600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eeeb3d0>]}
[0m23:35:19.616879 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.07s]
[0m23:35:19.617908 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:35:20.127227 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:35:20.128174 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:35:20.926246 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:ad0791de-8bbf-4f5c-afd5-c641f9a0139d&page=queryresults
[0m23:35:20.947986 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:35:19.585550 => 2023-02-06 23:35:20.947917
[0m23:35:20.950490 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eeeb700>]}
[0m23:35:20.950814 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m23:35:20.951499 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:35:20.951917 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:35:20.952069 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:35:20.952205 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:35:20.952373 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:35:20.952717 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:35:20.952963 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:35:20.953086 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:35:20.953195 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:35:20.962132 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:35:20.967702 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:35:20.967986 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:35:20.953271 => 2023-02-06 23:35:20.967952
[0m23:35:20.968115 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:35:20.972515 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:35:20.972781 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:35:20.962292 => 2023-02-06 23:35:20.972750
[0m23:35:20.972902 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:35:20.974629 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:35:20.974946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:20.975062 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:35:20.975253 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:35:20.975493 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:35:22.452518 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:1bb96903-5587-49ce-9210-6e1bc9e3931c&page=queryresults
[0m23:35:22.453327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2467e3f0-0b3d-4895-b468-788e80debe46&page=queryresults
[0m23:35:22.454329 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:35:20.972982 => 2023-02-06 23:35:22.454291
[0m23:35:22.455169 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:35:20.968191 => 2023-02-06 23:35:22.455151
[0m23:35:22.455561 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f0cd610>]}
[0m23:35:22.455874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f0cdfa0>]}
[0m23:35:22.456110 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m23:35:22.456317 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m23:35:22.456487 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:35:22.456601 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:35:34.898754 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:7a95f1c5-4f9b-46b3-9c56-95dd0fd88c4f&page=queryresults
[0m23:35:34.912772 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:35:19.574168 => 2023-02-06 23:35:34.912328
[0m23:35:34.914674 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7deed6-850d-4709-b1e5-6a6e08381f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee69640>]}
[0m23:35:34.916552 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.37s]
[0m23:35:34.916886 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:35:34.924030 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m23:35:34.926336 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:35:34.926643 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:35:34.931295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:34.932241 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:35:34.932341 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:35:34.932423 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:35:34.932596 [info ] [MainThread]: 
[0m23:35:34.933269 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 21.46 seconds (21.46s).
[0m23:35:34.937625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14edce7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eee3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eee3f70>]}
[0m23:35:34.938488 [debug] [MainThread]: Flushing usage events
[0m23:35:35.765687 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:35:35.772083 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-06 23:43:22.520922 | c135b6b8-762f-46ff-9142-a60e470bd6b8 ==============================
[0m23:43:22.520922 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:43:22.523660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:43:22.523826 [debug] [MainThread]: Tracking: tracking
[0m23:43:22.554436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc58100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc29f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc29e20>]}
[0m23:43:22.629350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:22.629556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:22.630011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m23:43:22.633589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe71e80>]}
[0m23:43:22.640796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd63820>]}
[0m23:43:22.641041 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:43:22.641180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd63a30>]}
[0m23:43:22.642036 [info ] [MainThread]: 
[0m23:43:22.642899 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:43:22.646665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:43:22.646797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:22.647252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m23:43:22.647376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:25.632200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m23:45:25.632721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m23:45:25.633647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:25.633794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:26.113447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc754c0>]}
[0m23:45:26.115860 [info ] [MainThread]: 
[0m23:45:26.116488 [info ] [MainThread]: Running 3 on-run-start hooks
[0m23:45:26.142895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:26.578814 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m23:45:26.582614 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m23:45:26.582892 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m23:45:26.905939 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m23:45:26.906331 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m23:45:26.906573 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m23:45:26.914523 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m23:45:26.915652 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m23:45:26.915956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        'c135b6b8-762f-46ff-9142-a60e470bd6b8'
    );



[0m23:45:27.419635 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:6e4e6356-f3cf-49e0-983d-5414407bf4cc&page=queryresults
[0m23:45:27.420458 [info ] [MainThread]: Database error while running on-run-start
[0m23:45:27.421388 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:45:27.421518 [info ] [MainThread]: 
[0m23:45:27.494124 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m23:45:27.494361 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m23:45:27.494492 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m23:45:27.495418 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m23:45:27.495652 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m23:45:27.495852 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m23:45:27.496268 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m23:45:27.496558 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m23:45:27.496852 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m23:45:27.496985 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m23:45:27.497628 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m23:45:27.497736 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m23:45:27.505262 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m23:45:27.513135 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m23:45:27.515709 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-06 23:45:27.498074 => 2023-02-06 23:45:27.515645
[0m23:45:27.517883 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-06 23:45:27.505413 => 2023-02-06 23:45:27.517860
[0m23:45:27.518007 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m23:45:27.537563 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m23:45:27.537902 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-06 23:45:27.501409 => 2023-02-06 23:45:27.537870
[0m23:45:27.538027 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m23:45:27.544630 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:45:27.545395 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:45:27.545553 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m23:45:27.555155 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:45:27.555389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fec3eb0>]}
[0m23:45:27.556140 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.06s]
[0m23:45:27.558617 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m23:45:28.035395 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m23:45:28.035889 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m23:45:28.709054 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4dcbb5f3-dce2-48f3-a314-ed746ef29cc8&page=queryresults
[0m23:45:28.721964 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-06 23:45:27.518072 => 2023-02-06 23:45:28.721904
[0m23:45:28.722590 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fec6130>]}
[0m23:45:28.722876 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m23:45:28.723063 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m23:45:28.723479 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m23:45:28.723642 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m23:45:28.723797 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m23:45:28.724386 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m23:45:28.724520 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m23:45:28.728132 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m23:45:28.724042 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m23:45:28.728542 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m23:45:28.728665 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m23:45:28.731619 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m23:45:28.731918 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-06 23:45:28.724598 => 2023-02-06 23:45:28.731881
[0m23:45:28.732042 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m23:45:28.733923 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m23:45:28.734133 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-06 23:45:28.728736 => 2023-02-06 23:45:28.734090
[0m23:45:28.734253 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m23:45:28.735934 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m23:45:28.736209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:45:28.736392 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m23:45:28.736987 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:45:28.737180 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m23:45:29.821509 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:f1c3995e-b276-42d2-8811-ff3530839021&page=queryresults
[0m23:45:29.822735 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-06 23:45:28.732115 => 2023-02-06 23:45:29.822690
[0m23:45:29.823123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fec3f10>]}
[0m23:45:29.823341 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m23:45:29.823511 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m23:45:29.824040 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2b851af8-ca77-4762-8d43-2d5a69b04b43&page=queryresults
[0m23:45:29.826909 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-06 23:45:28.734322 => 2023-02-06 23:45:29.826886
[0m23:45:29.829815 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128945490>]}
[0m23:45:29.830033 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m23:45:29.830201 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m23:45:45.659968 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:1267ed19-e659-45da-93a4-1aaf5e8dfcf2&page=queryresults
[0m23:45:45.675032 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-06 23:45:27.538097 => 2023-02-06 23:45:45.674704
[0m23:45:45.676220 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c135b6b8-762f-46ff-9142-a60e470bd6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fec62e0>]}
[0m23:45:45.676906 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 18.18s]
[0m23:45:45.677164 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m23:45:45.679333 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.users_report
[0m23:45:45.679969 [info ] [Thread-1  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m23:45:45.680171 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.users_report
[0m23:45:45.685332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:45.685593 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m23:45:45.685675 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m23:45:45.685747 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m23:45:45.685945 [info ] [MainThread]: 
[0m23:45:45.686816 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 2 minutes and 23.04 seconds (143.04s).
[0m23:45:45.689460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fec91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288032e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128803280>]}
[0m23:45:45.689671 [debug] [MainThread]: Flushing usage events
[0m23:45:46.449981 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m23:45:46.454893 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 01:55:03.312854 | 241c06b7-230b-40cc-8ff8-ba2335bb1a48 ==============================
[0m01:55:03.312854 [info ] [MainThread]: Running with dbt=1.4.1
[0m01:55:03.314287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:55:03.314402 [debug] [MainThread]: Tracking: tracking
[0m01:55:03.327487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149018100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fe9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fe9e20>]}
[0m01:55:03.376006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:55:03.376341 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m01:55:03.384991 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m01:55:03.386981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149123dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149245a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149245b20>]}
[0m01:55:03.387141 [debug] [MainThread]: Flushing usage events
[0m01:55:04.085762 [error] [MainThread]: Encountered an error:
Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  expected token 'end of print statement', got 'result'
    line 16
      result = run_query("


============================== 2023-02-07 01:56:19.121845 | 79c5a89c-8a54-4a04-9a49-8e90c65ee539 ==============================
[0m01:56:19.121845 [info ] [MainThread]: Running with dbt=1.4.1
[0m01:56:19.123354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:56:19.123494 [debug] [MainThread]: Tracking: tracking
[0m01:56:19.133094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145146a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145138910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145138b80>]}
[0m01:56:19.177971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:56:19.178352 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m01:56:19.186443 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m01:56:19.188492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145263e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145385b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145385bb0>]}
[0m01:56:19.188652 [debug] [MainThread]: Flushing usage events
[0m01:56:19.714562 [error] [MainThread]: Encountered an error:
Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  expected token 'end of print statement', got 'result'
    line 16
      result = run_query("


============================== 2023-02-07 02:07:49.093635 | 0961ebaf-a3b0-45dc-a9d4-4d4ce4c7069c ==============================
[0m02:07:49.093635 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:07:49.097311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:07:49.097594 [debug] [MainThread]: Tracking: tracking
[0m02:07:49.129268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c0bda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c0af940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c0afa90>]}
[0m02:07:49.210658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:07:49.210975 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://tests/assert_country_count.sql
[0m02:07:49.211111 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://tests/assert_page_views.sql
[0m02:07:49.211287 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m02:07:49.223544 [debug] [MainThread]: 1603: static parser failed on google_analytics/distinct_country_count.sql
[0m02:07:49.227653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c1ca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c4070d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c407160>]}
[0m02:07:49.227893 [debug] [MainThread]: Flushing usage events
[0m02:07:50.016343 [error] [MainThread]: Encountered an error:
Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  expected token 'end of print statement', got 'result'
    line 16
      result = run_query("


============================== 2023-02-07 02:10:28.719634 | 0c38cb57-84df-4810-be96-5a6d8e0bf329 ==============================
[0m02:10:28.719634 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:10:28.721404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:10:28.721555 [debug] [MainThread]: Tracking: tracking
[0m02:10:28.731436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f296a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f287940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f287a90>]}
[0m02:10:28.774950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:10:28.775233 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://tests/assert_page_views.sql
[0m02:10:28.775365 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://tests/assert_country_count.sql
[0m02:10:28.775508 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/distinct_country_count.sql
[0m02:10:28.784351 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m02:10:28.808864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:10:28.811890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f53d0d0>]}
[0m02:10:28.817380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5829a0>]}
[0m02:10:28.817577 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:10:28.817716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4e62b0>]}
[0m02:10:28.818576 [info ] [MainThread]: 
[0m02:10:28.819413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:10:28.820164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:10:28.820534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:10:28.820665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:10:28.820819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:10:30.419649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:10:30.420870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:10:30.421270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:10:30.421405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:10:30.945036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f583fa0>]}
[0m02:10:30.946799 [info ] [MainThread]: 
[0m02:10:30.947320 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:10:30.957835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:10:31.402357 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:10:31.408936 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:10:31.409950 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:10:31.814090 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:10:31.816376 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:10:31.817087 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:10:31.834592 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:10:31.835004 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:10:31.835289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '0c38cb57-84df-4810-be96-5a6d8e0bf329'
    );



[0m02:10:32.223808 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:16ec2ea1-e962-4dfd-bf58-46ea067e03fe&page=queryresults
[0m02:10:32.225306 [info ] [MainThread]: Database error while running on-run-start
[0m02:10:32.226803 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:10:32.227154 [info ] [MainThread]: 
[0m02:10:32.235176 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:10:32.235485 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:10:32.235893 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:10:32.236013 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:10:32.238652 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:10:32.238805 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:10:32.238940 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:10:32.239079 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:10:32.239574 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:10:32.239268 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:10:32.239789 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:10:32.239903 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:10:32.236094 => 2023-02-07 02:10:32.239854
[0m02:10:32.240159 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:10:32.243169 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m02:10:32.243298 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:10:32.243411 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:10:32.258055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:10:32.264149 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:10:32.240236 => 2023-02-07 02:10:32.264083
[0m02:10:32.266699 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:10:32.267319 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m02:10:32.269120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:10:32.270757 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:10:32.258270 => 2023-02-07 02:10:32.270726
[0m02:10:32.270901 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:10:32.286395 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m02:10:32.287121 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:10:32.287272 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m02:10:32.868586 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m02:10:32.869137 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m02:10:32.869745 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:10:32.870556 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:10:33.608632 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:f69f6c06-ed07-42e5-8730-af50c2ddc6ad&page=queryresults
[0m02:10:33.623847 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:10:32.270975 => 2023-02-07 02:10:33.623792
[0m02:10:33.624391 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6d7130>]}
[0m02:10:33.624608 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m02:10:33.625320 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:10:33.625579 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m02:10:33.625708 [info ] [Thread-3  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m02:10:33.625979 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m02:10:33.626079 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_deployments
[0m02:10:33.630127 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m02:10:33.630624 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 02:10:33.626148 => 2023-02-07 02:10:33.630600
[0m02:10:33.630732 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_deployments
[0m02:10:33.633151 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m02:10:33.633692 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:10:33.633829 [debug] [Thread-3  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m02:10:34.782335 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:82294e92-dc9b-4649-9fcd-887b458784e7&page=queryresults
[0m02:10:34.787057 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 02:10:33.630804 => 2023-02-07 02:10:34.786996
[0m02:10:34.787565 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f627880>]}
[0m02:10:34.787798 [info ] [Thread-3  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m02:10:34.787982 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:10:34.788143 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:10:34.788324 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m02:10:34.788654 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m02:10:34.788775 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m02:10:34.797739 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m02:10:34.798117 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 02:10:34.788856 => 2023-02-07 02:10:34.798090
[0m02:10:34.798223 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m02:10:34.800259 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m02:10:34.800512 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:10:34.800653 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m02:10:36.162263 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:d4b9f943-92a0-427f-9a09-296c65507b0a&page=queryresults
[0m02:10:36.165192 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 02:10:34.798294 => 2023-02-07 02:10:36.165131
[0m02:10:36.165682 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7779d0>]}
[0m02:10:36.165929 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m02:10:36.166113 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:10:47.991076 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4b970e66-1886-4e6e-8d14-f2d52f464205&page=queryresults
[0m02:10:47.997165 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 02:10:32.267471 => 2023-02-07 02:10:47.997047
[0m02:10:47.997744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f71edc0>]}
[0m02:10:47.998020 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.76s]
[0m02:10:47.998217 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:10:49.015206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:37b3dc72-6071-423e-ab6b-4024893c3b73&page=queryresults
[0m02:10:49.018662 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:10:32.243527 => 2023-02-07 02:10:49.018611
[0m02:10:49.019121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6bcc40>]}
[0m02:10:49.019365 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 16.78s]
[0m02:10:49.019550 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:10:49.020159 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:10:49.020676 [info ] [Thread-3  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m02:10:49.021309 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m02:10:49.021416 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m02:10:49.023751 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m02:10:49.024523 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 02:10:49.021486 => 2023-02-07 02:10:49.024460
[0m02:10:49.024793 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m02:10:49.026397 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m02:10:49.026623 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:10:49.026767 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m02:10:50.676908 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:3df79674-3319-4362-a0cd-1f8ed86070d2&page=queryresults
[0m02:10:50.681845 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 02:10:49.024864 => 2023-02-07 02:10:50.681677
[0m02:10:50.682562 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38cb57-84df-4810-be96-5a6d8e0bf329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6377f0>]}
[0m02:10:50.682864 [info ] [Thread-3  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m02:10:50.683060 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:10:50.683639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:10:50.683780 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:10:50.683986 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m02:10:50.684180 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m02:10:50.684493 [info ] [MainThread]: 
[0m02:10:50.684800 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 21.87 seconds (21.87s).
[0m02:10:50.685144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2c56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f8760>]}
[0m02:10:50.685272 [debug] [MainThread]: Flushing usage events
[0m02:10:51.374658 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:10:51.379252 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:11:31.236738 | 5dd2ca86-161d-4320-adf0-0ca03d1976dc ==============================
[0m02:11:31.236738 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:11:31.238010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:11:31.238116 [debug] [MainThread]: Tracking: tracking
[0m02:11:31.248095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e521100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4f2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e4f2e20>]}
[0m02:11:31.284089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:11:31.284281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:11:31.284698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:11:31.288029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd2ca86-161d-4320-adf0-0ca03d1976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8760d0>]}
[0m02:11:31.292875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd2ca86-161d-4320-adf0-0ca03d1976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7602b0>]}
[0m02:11:31.293070 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:11:31.293208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd2ca86-161d-4320-adf0-0ca03d1976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e760370>]}
[0m02:11:31.294043 [info ] [MainThread]: 
[0m02:11:31.294870 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:11:31.295733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:11:31.296038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:11:31.296210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:31.296385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:32.425516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd2ca86-161d-4320-adf0-0ca03d1976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e760130>]}
[0m02:11:32.427343 [info ] [MainThread]: 
[0m02:11:32.428107 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:11:32.439570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:32.945383 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:11:32.950634 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:11:32.951337 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:11:33.257966 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:11:33.259823 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:11:33.260463 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:11:33.271840 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:11:33.272379 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:11:33.272692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '5dd2ca86-161d-4320-adf0-0ca03d1976dc'
    );



[0m02:11:33.663277 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2c6a17b1-7d65-4403-8f68-01656550f1a8&page=queryresults
[0m02:11:33.664710 [info ] [MainThread]: Database error while running on-run-start
[0m02:11:33.666411 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:11:33.666784 [info ] [MainThread]: 
[0m02:11:33.673229 [debug] [Thread-1  ]: Began running node test.google_analytics_dbt.assert_country_count
[0m02:11:33.673506 [info ] [Thread-1  ]: 1 of 2 START test assert_country_count ......................................... [RUN]
[0m02:11:33.673931 [debug] [Thread-1  ]: Acquiring new bigquery connection 'test.google_analytics_dbt.assert_country_count'
[0m02:11:33.674054 [debug] [Thread-1  ]: Began compiling node test.google_analytics_dbt.assert_country_count
[0m02:11:33.675928 [debug] [Thread-2  ]: Began running node test.google_analytics_dbt.assert_page_views
[0m02:11:33.676824 [info ] [Thread-2  ]: 2 of 2 START test assert_page_views ............................................ [RUN]
[0m02:11:33.677338 [debug] [Thread-2  ]: Acquiring new bigquery connection 'test.google_analytics_dbt.assert_page_views'
[0m02:11:33.677450 [debug] [Thread-2  ]: Began compiling node test.google_analytics_dbt.assert_page_views
[0m02:11:33.680305 [debug] [Thread-2  ]: Writing injected SQL for node "test.google_analytics_dbt.assert_page_views"
[0m02:11:33.682187 [debug] [Thread-1  ]: Writing injected SQL for node "test.google_analytics_dbt.assert_country_count"
[0m02:11:33.682810 [debug] [Thread-1  ]: Timing info for test.google_analytics_dbt.assert_country_count (compile): 2023-02-07 02:11:33.674134 => 2023-02-07 02:11:33.682725
[0m02:11:33.682902 [debug] [Thread-2  ]: Timing info for test.google_analytics_dbt.assert_page_views (compile): 2023-02-07 02:11:33.677517 => 2023-02-07 02:11:33.682879
[0m02:11:33.683568 [debug] [Thread-1  ]: Began executing node test.google_analytics_dbt.assert_country_count
[0m02:11:33.683678 [debug] [Thread-2  ]: Began executing node test.google_analytics_dbt.assert_page_views
[0m02:11:33.697196 [debug] [Thread-1  ]: Writing runtime sql for node "test.google_analytics_dbt.assert_country_count"
[0m02:11:33.699139 [debug] [Thread-2  ]: Writing runtime sql for node "test.google_analytics_dbt.assert_page_views"
[0m02:11:33.699880 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:11:33.700045 [debug] [Thread-2  ]: On test.google_analytics_dbt.assert_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "test.google_analytics_dbt.assert_page_views"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
    operationSystem,
    totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
WHERE totalPageViews < 0 OR totalPageViews IS NULL
      
    ) dbt_internal_test
[0m02:11:33.700663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:11:33.700812 [debug] [Thread-1  ]: On test.google_analytics_dbt.assert_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "test.google_analytics_dbt.assert_country_count"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
    operationSystem,
    distincCountCountry
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
WHERE distincCountCountry < 0 OR distincCountCountry IS NULL
      
    ) dbt_internal_test
[0m02:11:35.491721 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:bb355271-ce07-4e6a-8a89-eccd5f12bc97&page=queryresults
[0m02:11:35.493733 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:70b1ff8f-9f33-4901-9118-8bf4eea30a0d&page=queryresults
[0m02:11:35.496406 [debug] [Thread-1  ]: Timing info for test.google_analytics_dbt.assert_country_count (execute): 2023-02-07 02:11:33.683754 => 2023-02-07 02:11:35.496233
[0m02:11:35.497145 [debug] [Thread-2  ]: Timing info for test.google_analytics_dbt.assert_page_views (execute): 2023-02-07 02:11:33.697298 => 2023-02-07 02:11:35.497092
[0m02:11:35.498710 [info ] [Thread-1  ]: 1 of 2 PASS assert_country_count ............................................... [[32mPASS[0m in 1.82s]
[0m02:11:35.500243 [info ] [Thread-2  ]: 2 of 2 PASS assert_page_views .................................................. [[32mPASS[0m in 1.82s]
[0m02:11:35.501306 [debug] [Thread-1  ]: Finished running node test.google_analytics_dbt.assert_country_count
[0m02:11:35.501472 [debug] [Thread-2  ]: Finished running node test.google_analytics_dbt.assert_page_views
[0m02:11:35.502200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:35.502300 [debug] [MainThread]: Connection 'test.google_analytics_dbt.assert_country_count' was properly closed.
[0m02:11:35.502370 [debug] [MainThread]: Connection 'test.google_analytics_dbt.assert_page_views' was properly closed.
[0m02:11:35.502482 [info ] [MainThread]: 
[0m02:11:35.502608 [info ] [MainThread]: Finished running 2 tests, 2 hooks in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m02:11:35.502852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e53e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7600d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e760130>]}
[0m02:11:35.503011 [debug] [MainThread]: Flushing usage events
[0m02:11:36.059571 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:11:36.063211 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:19:25.416674 | 4643d437-61a2-4222-9840-3a00ccc23b2b ==============================
[0m02:19:25.416674 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:19:25.418189 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m02:19:25.418353 [debug] [MainThread]: Tracking: tracking
[0m02:19:25.434949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fc5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fb7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fb7a30>]}
[0m02:19:25.437983 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m02:19:25.438223 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m02:19:25.438365 [info ] [MainThread]: 
[0m02:19:25.438476 [info ] [MainThread]: 
[0m02:19:25.438571 [info ] [MainThread]: Press Ctrl+C to exit.
[0m02:33:23.195539 [debug] [MainThread]: Flushing usage events
[0m02:33:23.392734 [info ] [MainThread]: ctrl-c


============================== 2023-02-07 02:33:30.140868 | 1e313642-568f-4cf4-a70a-a4421cc624f3 ==============================
[0m02:33:30.140868 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:33:30.142142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:33:30.142258 [debug] [MainThread]: Tracking: tracking
[0m02:33:30.152899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4c6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4b7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4b7a60>]}
[0m02:33:30.204277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m02:33:30.204576 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://macros/logging.sql
[0m02:33:30.204750 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/sources.yml
[0m02:33:30.205003 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/schema.yml
[0m02:33:30.205110 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/total_page_views.sql
[0m02:33:30.214409 [debug] [MainThread]: 1603: static parser failed on google_analytics/total_page_views.sql
[0m02:33:30.217049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4f6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e712dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7184c0>]}
[0m02:33:30.217220 [debug] [MainThread]: Flushing usage events
[0m02:33:30.785870 [error] [MainThread]: Encountered an error:
no loader for this environment specified
[0m02:33:30.791773 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 165, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 94, in _runtime_initialize
    self.load_manifest()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 203, in get_full_manifest
    manifest = loader.load()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 339, in load
    self.parse_project(
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 467, in parse_project
    parser.parse_file(block)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 425, in parse_file
    self.parse_node(file_block)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 386, in parse_node
    self.render_update(node, config)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/models.py", line 362, in render_update
    super().render_update(node, config)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 362, in render_update
    context = self.render_with_context(node, config)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 240, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 590, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 545, in render_template
    return template.render(ctx)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 2, in top-level template code
TypeError: no loader for this environment specified



============================== 2023-02-07 02:34:45.899184 | 033bf32b-f832-4f9b-9bd6-1f24979ceec6 ==============================
[0m02:34:45.899184 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:34:45.900768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:34:45.900911 [debug] [MainThread]: Tracking: tracking
[0m02:34:45.910964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d417130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d3e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d3e9220>]}
[0m02:34:45.955598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m02:34:45.955864 [debug] [MainThread]: Partial parsing: added file: google_analytics_dbt://macros/logging.sql
[0m02:34:45.956155 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/schema.yml
[0m02:34:45.956288 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/sources.yml
[0m02:34:45.956391 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/total_page_views.sql
[0m02:34:45.966909 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/total_page_views.sql
[0m02:34:45.972809 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m02:34:45.974447 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/users_report.sql
[0m02:34:45.985569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:34:45.988869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6870d0>]}
[0m02:34:45.993771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d521730>]}
[0m02:34:45.993980 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 462 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:34:45.994115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d406c40>]}
[0m02:34:45.994936 [info ] [MainThread]: 
[0m02:34:45.995748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:34:45.996451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:34:45.996745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:34:45.996900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:45.997021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:47.729619 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:34:47.730902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:34:47.731443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:47.731763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:48.264744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d5215e0>]}
[0m02:34:48.266346 [info ] [MainThread]: 
[0m02:34:48.267244 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:34:48.275037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:48.727898 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:34:48.732776 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:34:48.733571 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:34:49.064797 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:34:49.065626 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:34:49.066114 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:34:49.083012 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:34:49.084254 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:34:49.084548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '033bf32b-f832-4f9b-9bd6-1f24979ceec6'
    );



[0m02:34:49.467669 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:923fa080-db3f-4926-8fa3-6a1f8ee9fec7&page=queryresults
[0m02:34:49.468947 [info ] [MainThread]: Database error while running on-run-start
[0m02:34:49.470379 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:34:49.470736 [info ] [MainThread]: 
[0m02:34:49.476662 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:34:49.477164 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:34:49.477594 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:34:49.478072 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:34:49.478543 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:34:49.478730 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:34:49.479241 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:34:49.479503 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:34:49.480044 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:34:49.480178 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:34:49.480277 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:34:49.480368 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:34:49.482364 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:34:49.483916 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m02:34:49.495052 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:34:49.495386 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:34:49.480441 => 2023-02-07 02:34:49.495311
[0m02:34:49.495544 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:34:49.495633 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:34:49.482466 => 2023-02-07 02:34:49.495609
[0m02:34:49.501626 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:34:49.484000 => 2023-02-07 02:34:49.501598
[0m02:34:49.504878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:34:49.505079 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m02:34:49.505231 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:34:49.507178 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:34:49.528579 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:34:49.507527 => 2023-02-07 02:34:49.528530
[0m02:34:49.531854 [debug] [Thread-3  ]: Compilation Error in model stg_dbt_audit_log (models/stg_dbt_audit_log.sql)
  'configure' is undefined
  
  > in macro statement (macros/etc/statement.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_dbt_audit_log (models/stg_dbt_audit_log.sql)
[0m02:34:49.532061 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d8656d0>]}
[0m02:34:49.532266 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[31mERROR[0m in 0.05s]
[0m02:34:49.532976 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:34:49.533260 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m02:34:49.533391 [info ] [Thread-3  ]: 4 of 6 SKIP relation google_analytics_sample_meta.stg_dbt_deployments .......... [[33mSKIP[0m]
[0m02:34:49.533538 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:34:49.533658 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:34:49.533774 [info ] [Thread-3  ]: 5 of 6 SKIP relation google_analytics_sample_meta.stg_dbt_model_deployments .... [[33mSKIP[0m]
[0m02:34:49.533899 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:34:50.006836 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 02:34:49.505847 => 2023-02-07 02:34:50.006815
[0m02:34:50.004784 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:34:49.495725 => 2023-02-07 02:34:50.004695
[0m02:34:50.007467 [debug] [Thread-2  ]: Compilation Error in model total_page_views (models/google_analytics/total_page_views.sql)
  'configure' is undefined
  
  > in macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model total_page_views (models/google_analytics/total_page_views.sql)
[0m02:34:50.008437 [debug] [Thread-1  ]: Compilation Error in model distinct_country_count (models/google_analytics/distinct_country_count.sql)
  'configure' is undefined
  
  > in macro statement (macros/etc/statement.sql)
  > called by macro materialization_table_bigquery (macros/materializations/table.sql)
  > called by model distinct_country_count (models/google_analytics/distinct_country_count.sql)
[0m02:34:50.008739 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d417640>]}
[0m02:34:50.008926 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '033bf32b-f832-4f9b-9bd6-1f24979ceec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d878340>]}
[0m02:34:50.009120 [error] [Thread-2  ]: 2 of 6 ERROR creating sql table model google_analytics_sample.total_page_views . [[31mERROR[0m in 0.53s]
[0m02:34:50.009329 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model google_analytics_sample.distinct_country_count  [[31mERROR[0m in 0.53s]
[0m02:34:50.009495 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:34:50.009603 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:34:50.009940 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:34:50.010056 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m02:34:50.010251 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:34:50.010668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:50.010752 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:34:50.010820 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m02:34:50.010884 [debug] [MainThread]: Connection 'model.logging.stg_dbt_audit_log' was properly closed.
[0m02:34:50.010986 [info ] [MainThread]: 
[0m02:34:50.011095 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m02:34:50.011259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6b8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d8fafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d8fa9d0>]}
[0m02:34:50.011452 [debug] [MainThread]: Flushing usage events
[0m02:34:50.681487 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:34:50.685453 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:36:08.235456 | e254a9ce-12af-405b-88ed-033df5d9c1b6 ==============================
[0m02:36:08.235456 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:36:08.239480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:36:08.239699 [debug] [MainThread]: Tracking: tracking
[0m02:36:08.250662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129a46a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129a37940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129a37bb0>]}
[0m02:36:08.295858 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m02:36:08.296077 [debug] [MainThread]: Partial parsing: deleted file: google_analytics_dbt://macros/logging.sql
[0m02:36:08.300170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:36:08.303301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129da40d0>]}
[0m02:36:08.307975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d13dc0>]}
[0m02:36:08.308162 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:36:08.308302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d3be80>]}
[0m02:36:08.309178 [info ] [MainThread]: 
[0m02:36:08.310008 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:36:08.310713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:36:08.310906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:08.311202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:36:08.311510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:10.059407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:36:10.061404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:36:10.062030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:10.062465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:10.573982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d41b80>]}
[0m02:36:10.574390 [info ] [MainThread]: 
[0m02:36:10.574566 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:36:10.585175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:11.100418 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:36:11.104423 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:36:11.104789 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:36:11.487903 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:36:11.489314 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:36:11.490050 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:36:11.503663 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:36:11.504210 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:36:11.504524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        'e254a9ce-12af-405b-88ed-033df5d9c1b6'
    );



[0m02:36:11.797432 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:52c2fd12-976a-4767-897f-b049881c031c&page=queryresults
[0m02:36:11.798916 [info ] [MainThread]: Database error while running on-run-start
[0m02:36:11.800442 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:36:11.800796 [info ] [MainThread]: 
[0m02:36:11.805746 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:36:11.806104 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:36:11.806531 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:36:11.806766 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:36:11.806880 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:36:11.806986 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:36:11.807122 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:36:11.809255 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:36:11.809415 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:36:11.809735 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:36:11.810042 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:36:11.810245 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:36:11.810373 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:36:11.807459 => 2023-02-07 02:36:11.810316
[0m02:36:11.810479 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:36:11.813147 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m02:36:11.813273 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:36:11.825006 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:36:11.836086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:11.836430 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:36:11.810557 => 2023-02-07 02:36:11.836394
[0m02:36:11.837138 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m02:36:11.838414 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:36:11.839017 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:36:11.813353 => 2023-02-07 02:36:11.838987
[0m02:36:11.839133 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:36:11.857429 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m02:36:11.858006 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:36:11.858147 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m02:36:12.291106 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m02:36:12.291936 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:36:12.383563 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m02:36:12.384845 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:36:13.095051 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2dee2ddc-4f15-441f-accc-2f9d1e3110d6&page=queryresults
[0m02:36:13.112459 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:36:11.839205 => 2023-02-07 02:36:13.112399
[0m02:36:13.113254 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a802670>]}
[0m02:36:13.113708 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m02:36:13.114721 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:36:13.114979 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m02:36:13.115130 [info ] [Thread-3  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m02:36:13.115428 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m02:36:13.115528 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_deployments
[0m02:36:13.124473 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m02:36:13.125003 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 02:36:13.115594 => 2023-02-07 02:36:13.124978
[0m02:36:13.125110 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_deployments
[0m02:36:13.127129 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m02:36:13.127361 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:36:13.127499 [debug] [Thread-3  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m02:36:14.357382 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:e29c58ef-fc0f-42f8-bc1b-351e7ec640e9&page=queryresults
[0m02:36:14.362458 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 02:36:13.125178 => 2023-02-07 02:36:14.362407
[0m02:36:14.362971 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129eead90>]}
[0m02:36:14.363219 [info ] [Thread-3  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m02:36:14.363404 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:36:14.363559 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:36:14.363685 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m02:36:14.363981 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m02:36:14.364087 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m02:36:14.370851 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m02:36:14.371155 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 02:36:14.364378 => 2023-02-07 02:36:14.371131
[0m02:36:14.371262 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m02:36:14.373517 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m02:36:14.373741 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:36:14.373885 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m02:36:15.586879 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:0253796f-a3a2-4b1a-9a7f-3323ecefe23a&page=queryresults
[0m02:36:15.589665 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 02:36:14.371328 => 2023-02-07 02:36:15.589620
[0m02:36:15.590138 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a840190>]}
[0m02:36:15.590400 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m02:36:15.590599 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:36:27.564621 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:6a52ef6a-f719-43c8-ad6f-aa505bacfc6d&page=queryresults
[0m02:36:27.568204 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 02:36:11.837232 => 2023-02-07 02:36:27.568113
[0m02:36:27.569444 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129dd4a60>]}
[0m02:36:27.570042 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.76s]
[0m02:36:27.570532 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:36:29.632255 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c8eb1276-2b8d-44c5-966e-02a88f5004b1&page=queryresults
[0m02:36:29.637408 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:36:11.825158 => 2023-02-07 02:36:29.637272
[0m02:36:29.639274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129dd49d0>]}
[0m02:36:29.640335 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 17.83s]
[0m02:36:29.641186 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:36:29.642364 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:36:29.643170 [info ] [Thread-3  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m02:36:29.644253 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m02:36:29.644553 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m02:36:29.653557 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m02:36:29.654877 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 02:36:29.644750 => 2023-02-07 02:36:29.654799
[0m02:36:29.655196 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m02:36:29.658964 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m02:36:29.659684 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:36:29.659830 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m02:36:30.704201 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c29a3ac6-5fd0-4357-8194-97967d456128&page=queryresults
[0m02:36:30.710005 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 02:36:29.655392 => 2023-02-07 02:36:30.709857
[0m02:36:30.712103 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e254a9ce-12af-405b-88ed-033df5d9c1b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a899970>]}
[0m02:36:30.713377 [info ] [Thread-3  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m02:36:30.714356 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:36:30.716831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:30.717452 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:36:30.717987 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m02:36:30.718414 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m02:36:30.719110 [info ] [MainThread]: 
[0m02:36:30.719678 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 22.41 seconds (22.41s).
[0m02:36:30.720502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129e22040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129df17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129df1820>]}
[0m02:36:30.720999 [debug] [MainThread]: Flushing usage events
[0m02:36:31.332540 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:36:31.337471 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:54:09.175370 | 5857193e-e0bf-4db1-a427-7eddb829b12f ==============================
[0m02:54:09.175370 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:54:09.177710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:09.178026 [debug] [MainThread]: Tracking: tracking
[0m02:54:09.191998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241c6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241b8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241b8a90>]}
[0m02:54:09.239437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:09.239765 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/total_page_views.sql
[0m02:54:09.248367 [debug] [MainThread]: 1603: static parser failed on google_analytics/total_page_views.sql
[0m02:54:09.255207 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/total_page_views.sql
[0m02:54:09.264174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:54:09.267152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124459dc0>]}
[0m02:54:09.271984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241f5bb0>]}
[0m02:54:09.272176 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:54:09.272314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124394f70>]}
[0m02:54:09.273122 [info ] [MainThread]: 
[0m02:54:09.273950 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:54:09.274665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:54:09.274867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:09.275140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:54:09.275444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:10.953865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:54:10.955239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:54:10.955988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:10.956358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:11.432181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124394fd0>]}
[0m02:54:11.432736 [info ] [MainThread]: 
[0m02:54:11.433081 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:54:11.446671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:12.040607 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:54:12.045017 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:54:12.045395 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:54:12.449835 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:54:12.451645 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:54:12.452244 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:54:12.465338 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:54:12.465897 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:54:12.466211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '5857193e-e0bf-4db1-a427-7eddb829b12f'
    );



[0m02:54:12.860496 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:78c1d5a8-d632-4cb4-ab19-a4db295e79d6&page=queryresults
[0m02:54:12.861887 [info ] [MainThread]: Database error while running on-run-start
[0m02:54:12.862618 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:54:12.862773 [info ] [MainThread]: 
[0m02:54:12.867201 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:54:12.867372 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:54:12.867553 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:54:12.867713 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:54:12.868109 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:54:12.869150 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:54:12.869535 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:54:12.870138 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:54:12.870254 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:54:12.870491 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:54:12.870589 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:54:12.873640 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:54:12.873968 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:54:12.876853 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m02:54:12.886555 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:54:12.886838 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:54:12.870661 => 2023-02-07 02:54:12.886781
[0m02:54:12.886989 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:54:12.893882 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:54:12.877005 => 2023-02-07 02:54:12.893854
[0m02:54:12.893980 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:54:12.874171 => 2023-02-07 02:54:12.893960
[0m02:54:12.897416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:54:12.897607 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:54:12.897718 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m02:54:12.915507 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m02:54:12.917459 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:54:12.918767 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:54:12.918903 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m02:54:13.495594 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m02:54:13.498134 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m02:54:13.499495 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:54:13.500273 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      


SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:54:14.141684 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:7311f956-1fbb-46fe-bbf1-b12696d8a964&page=queryresults
[0m02:54:14.162404 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:54:12.898279 => 2023-02-07 02:54:14.162363
[0m02:54:14.162862 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244e1070>]}
[0m02:54:14.163084 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m02:54:14.165459 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:54:14.166053 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m02:54:14.166438 [info ] [Thread-3  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m02:54:14.166801 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m02:54:14.166903 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_deployments
[0m02:54:14.171675 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m02:54:14.171992 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 02:54:14.166972 => 2023-02-07 02:54:14.171969
[0m02:54:14.172096 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_deployments
[0m02:54:14.173694 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m02:54:14.173974 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:54:14.174116 [debug] [Thread-3  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m02:54:15.221447 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:80ae8217-b885-4aa5-830d-555dd0c43018&page=queryresults
[0m02:54:15.225294 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 02:54:14.172163 => 2023-02-07 02:54:15.225204
[0m02:54:15.226401 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246db040>]}
[0m02:54:15.227144 [info ] [Thread-3  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m02:54:15.227860 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:54:15.228018 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:54:15.228155 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m02:54:15.228579 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m02:54:15.228706 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m02:54:15.233961 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m02:54:15.234310 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 02:54:15.228779 => 2023-02-07 02:54:15.234281
[0m02:54:15.234425 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m02:54:15.237658 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m02:54:15.237880 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:54:15.238020 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m02:54:16.265215 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:e32363c5-5124-4ae2-8b2b-e9c357de77f8&page=queryresults
[0m02:54:16.268695 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 02:54:15.234496 => 2023-02-07 02:54:16.268646
[0m02:54:16.269179 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246db160>]}
[0m02:54:16.269416 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m02:54:16.269595 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:54:29.141677 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c60059fa-0fe4-4b70-b714-d387c77129eb&page=queryresults
[0m02:54:29.142948 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:96ea36fb-ef04-4e7c-adc3-091111c86961&page=queryresults
[0m02:54:29.148072 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 02:54:12.915825 => 2023-02-07 02:54:29.147894
[0m02:54:29.152845 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:54:12.887071 => 2023-02-07 02:54:29.152758
[0m02:54:29.154571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244e1400>]}
[0m02:54:29.155718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244e4460>]}
[0m02:54:29.156611 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 16.28s]
[0m02:54:29.157269 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 16.29s]
[0m02:54:29.157848 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:54:29.158273 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:54:29.159747 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:54:29.160382 [info ] [Thread-3  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m02:54:29.161318 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m02:54:29.161821 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m02:54:29.165716 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m02:54:29.166211 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 02:54:29.162102 => 2023-02-07 02:54:29.166176
[0m02:54:29.166332 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m02:54:29.169342 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m02:54:29.169612 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:54:29.169760 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m02:54:30.266622 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:7db1ca49-735e-4664-bb63-a4c771a3ae6f&page=queryresults
[0m02:54:30.274432 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 02:54:29.166406 => 2023-02-07 02:54:30.274342
[0m02:54:30.275712 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5857193e-e0bf-4db1-a427-7eddb829b12f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124867e50>]}
[0m02:54:30.276290 [info ] [Thread-3  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m02:54:30.276750 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:54:30.277786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:30.278047 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:54:30.278257 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m02:54:30.278462 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m02:54:30.278763 [info ] [MainThread]: 
[0m02:54:30.279078 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 21.01 seconds (21.01s).
[0m02:54:30.279533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244c0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12443c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12443c850>]}
[0m02:54:30.279849 [debug] [MainThread]: Flushing usage events
[0m02:54:30.929672 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:54:30.933904 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:55:24.085294 | 4b444548-285e-4cb4-a433-01f49d097ce2 ==============================
[0m02:55:24.085294 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:55:24.086889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:55:24.087030 [debug] [MainThread]: Tracking: tracking
[0m02:55:24.096187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135506a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354f8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354f8a60>]}
[0m02:55:24.140086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:55:24.140412 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/total_page_views.sql
[0m02:55:24.149521 [debug] [MainThread]: 1603: static parser failed on google_analytics/total_page_views.sql
[0m02:55:24.156647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/total_page_views.sql
[0m02:55:24.165307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:55:24.168199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13609bd90>]}
[0m02:55:24.172910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355361f0>]}
[0m02:55:24.173103 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:55:24.173245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135777040>]}
[0m02:55:24.174057 [info ] [MainThread]: 
[0m02:55:24.174878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:55:24.175570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:55:24.175899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:55:24.176061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:24.176195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:25.670394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:55:25.670950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:55:25.671232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:25.671369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:26.171828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13552d370>]}
[0m02:55:26.173375 [info ] [MainThread]: 
[0m02:55:26.173873 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:55:26.188601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:26.671884 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:55:26.676998 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:55:26.677717 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:55:26.998305 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:55:27.000179 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:55:27.000869 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:55:27.015514 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:55:27.017307 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:55:27.017614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '4b444548-285e-4cb4-a433-01f49d097ce2'
    );



[0m02:55:27.306224 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:17b417c6-18db-4247-8801-0eaf93ee8883&page=queryresults
[0m02:55:27.307394 [info ] [MainThread]: Database error while running on-run-start
[0m02:55:27.309120 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:55:27.309686 [info ] [MainThread]: 
[0m02:55:27.315863 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:55:27.316286 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:55:27.316646 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:55:27.317168 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:55:27.317560 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:55:27.317737 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:55:27.318121 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:55:27.318379 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:55:27.318657 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:55:27.318777 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:55:27.318974 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:55:27.319071 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:55:27.322919 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:55:27.338293 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:55:27.338640 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:55:27.323023 => 2023-02-07 02:55:27.338599
[0m02:55:27.339427 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:55:27.319150 => 2023-02-07 02:55:27.339380
[0m02:55:27.339534 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:55:27.327566 => 2023-02-07 02:55:27.339517
[0m02:55:27.339687 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:55:27.339806 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:55:27.349778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:27.369570 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m02:55:27.370323 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:55:27.370536 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m02:55:27.372305 [debug] [Thread-2  ]: Compilation Error in model total_page_views (models/google_analytics/total_page_views.sql)
  'dict object' has no attribute 'getLogger'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:55:27.372483 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136172790>]}
[0m02:55:27.372712 [error] [Thread-2  ]: 2 of 6 ERROR creating sql table model google_analytics_sample.total_page_views . [[31mERROR[0m in 0.05s]
[0m02:55:27.373654 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:55:27.904641 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m02:55:27.905012 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:55:28.357816 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4d1bd20f-7aa8-4fcb-9f25-7728930f67ad&page=queryresults
[0m02:55:28.374599 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:55:27.349961 => 2023-02-07 02:55:28.374565
[0m02:55:28.374995 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13614bee0>]}
[0m02:55:28.375205 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m02:55:28.375379 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:55:28.375624 [debug] [Thread-2  ]: Began running node model.logging.stg_dbt_deployments
[0m02:55:28.375747 [info ] [Thread-2  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m02:55:28.375982 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:55:28.376627 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m02:55:28.376980 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m02:55:28.377321 [debug] [Thread-2  ]: Began compiling node model.logging.stg_dbt_deployments
[0m02:55:28.377922 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m02:55:28.384534 [debug] [Thread-2  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m02:55:28.385079 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m02:55:28.390014 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m02:55:28.390348 [debug] [Thread-2  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 02:55:28.378107 => 2023-02-07 02:55:28.390317
[0m02:55:28.390467 [debug] [Thread-2  ]: Began executing node model.logging.stg_dbt_deployments
[0m02:55:28.392600 [debug] [Thread-2  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m02:55:28.393545 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 02:55:28.385260 => 2023-02-07 02:55:28.393522
[0m02:55:28.393651 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m02:55:28.395204 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m02:55:28.395415 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:55:28.395557 [debug] [Thread-2  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m02:55:28.395742 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:55:28.396203 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m02:55:29.582752 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:599ce7c7-8e23-44a2-a0c8-c2d0c441a0fa&page=queryresults
[0m02:55:29.584470 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c33e2948-df48-4ad9-9de9-e788331c36aa&page=queryresults
[0m02:55:29.585972 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 02:55:28.393721 => 2023-02-07 02:55:29.585919
[0m02:55:29.587343 [debug] [Thread-2  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 02:55:28.390537 => 2023-02-07 02:55:29.587296
[0m02:55:29.588258 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363bd790>]}
[0m02:55:29.589027 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13614bd90>]}
[0m02:55:29.589524 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m02:55:29.589748 [info ] [Thread-2  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m02:55:29.589917 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:55:29.590034 [debug] [Thread-2  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:55:44.405988 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:9e883949-f06e-460f-8e6c-f9f8571b8fa0&page=queryresults
[0m02:55:44.410902 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:55:27.339890 => 2023-02-07 02:55:44.410858
[0m02:55:44.411378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b444548-285e-4cb4-a433-01f49d097ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13611b2e0>]}
[0m02:55:44.411611 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 17.09s]
[0m02:55:44.411784 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:55:44.412174 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:55:44.412354 [info ] [Thread-3  ]: 6 of 6 SKIP relation google_analytics_sample.users_report ...................... [[33mSKIP[0m]
[0m02:55:44.412503 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:55:44.412936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:44.413032 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:55:44.413106 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m02:55:44.413173 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m02:55:44.413277 [info ] [MainThread]: 
[0m02:55:44.413395 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 20.24 seconds (20.24s).
[0m02:55:44.413568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13609bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136104070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136104130>]}
[0m02:55:44.413800 [debug] [MainThread]: Flushing usage events
[0m02:55:44.968887 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:55:44.971849 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 02:56:34.780076 | effa6c2c-734d-42a3-8f85-9519966d4538 ==============================
[0m02:56:34.780076 [info ] [MainThread]: Running with dbt=1.4.1
[0m02:56:34.781568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:56:34.781717 [debug] [MainThread]: Tracking: tracking
[0m02:56:34.791739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136446a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136438910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136438a60>]}
[0m02:56:34.835706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:56:34.836046 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/total_page_views.sql
[0m02:56:34.844771 [debug] [MainThread]: 1603: static parser failed on google_analytics/total_page_views.sql
[0m02:56:34.851571 [debug] [MainThread]: 1602: parser fallback to jinja rendering on google_analytics/total_page_views.sql
[0m02:56:34.860208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m02:56:34.863086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366d8d90>]}
[0m02:56:34.867708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1364751f0>]}
[0m02:56:34.867896 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m02:56:34.868030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1365b6040>]}
[0m02:56:34.868860 [info ] [MainThread]: 
[0m02:56:34.869673 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:56:34.870360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:56:34.870717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m02:56:34.870886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:34.871017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:36.429183 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m02:56:36.430792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m02:56:36.431345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:36.431488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:36.935243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13663fbb0>]}
[0m02:56:36.936764 [info ] [MainThread]: 
[0m02:56:36.937430 [info ] [MainThread]: Running 3 on-run-start hooks
[0m02:56:36.949985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:37.549939 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m02:56:37.554548 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m02:56:37.555268 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m02:56:37.960227 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m02:56:37.961849 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m02:56:37.962387 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m02:56:37.972740 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m02:56:37.973307 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m02:56:37.973702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        'effa6c2c-734d-42a3-8f85-9519966d4538'
    );



[0m02:56:38.269472 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:094ff316-c881-4783-8f9c-09dd7ff4df79&page=queryresults
[0m02:56:38.270745 [info ] [MainThread]: Database error while running on-run-start
[0m02:56:38.271232 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m02:56:38.271357 [info ] [MainThread]: 
[0m02:56:38.275395 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m02:56:38.275627 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m02:56:38.275955 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m02:56:38.276067 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m02:56:38.278054 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m02:56:38.278411 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m02:56:38.278734 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m02:56:38.279057 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m02:56:38.279499 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m02:56:38.280048 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m02:56:38.280164 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 02:56:38.276148 => 2023-02-07 02:56:38.280116
[0m02:56:38.280437 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m02:56:38.280539 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m02:56:38.280642 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m02:56:38.280742 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m02:56:38.283080 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m02:56:38.296585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:38.308898 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m02:56:38.309869 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 02:56:38.280811 => 2023-02-07 02:56:38.309827
[0m02:56:38.310005 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m02:56:38.311249 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:56:38.312218 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 02:56:38.296751 => 2023-02-07 02:56:38.312190
[0m02:56:38.312337 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m02:56:38.328287 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m02:56:38.328957 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:56:38.329101 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m02:56:38.802399 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m02:56:38.804110 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m02:56:38.804492 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:56:38.805034 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      



SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m02:56:39.546684 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:38f9d020-4245-4f9b-88e1-5eb8cb0f82cc&page=queryresults
[0m02:56:39.564080 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 02:56:38.312409 => 2023-02-07 02:56:39.564018
[0m02:56:39.564898 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136810670>]}
[0m02:56:39.565364 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m02:56:39.566974 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m02:56:39.567309 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m02:56:39.567433 [info ] [Thread-3  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m02:56:39.567707 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m02:56:39.567808 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_deployments
[0m02:56:39.571141 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m02:56:39.571466 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 02:56:39.567873 => 2023-02-07 02:56:39.571444
[0m02:56:39.571569 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_deployments
[0m02:56:39.573174 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m02:56:39.573397 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:56:39.573528 [debug] [Thread-3  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m02:56:40.827913 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:8f937392-3752-4b3f-82fa-0756e076e757&page=queryresults
[0m02:56:40.831519 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 02:56:39.571634 => 2023-02-07 02:56:40.831478
[0m02:56:40.831929 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368109d0>]}
[0m02:56:40.832149 [info ] [Thread-3  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m02:56:40.832320 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m02:56:40.832475 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m02:56:40.833073 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m02:56:40.834186 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m02:56:40.834554 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m02:56:40.839134 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m02:56:40.839854 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 02:56:40.834753 => 2023-02-07 02:56:40.839787
[0m02:56:40.839966 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m02:56:40.842551 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m02:56:40.842769 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:56:40.842904 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m02:56:42.160022 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:e8986127-4e96-4f0b-9eb7-513427d27cc6&page=queryresults
[0m02:56:42.164809 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 02:56:40.840043 => 2023-02-07 02:56:42.164750
[0m02:56:42.165313 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368e1fd0>]}
[0m02:56:42.165558 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m02:56:42.165727 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m02:56:52.890787 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:d7454250-5fdc-4328-beca-c72cc999c769&page=queryresults
[0m02:56:52.897121 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 02:56:38.283294 => 2023-02-07 02:56:52.896917
[0m02:56:52.898856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13675a2b0>]}
[0m02:56:52.899776 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 14.62s]
[0m02:56:52.900293 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m02:56:53.075945 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:0c21b509-33e9-41bf-aa94-59309bea6e00&page=queryresults
[0m02:56:53.078793 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 02:56:38.310077 => 2023-02-07 02:56:53.078709
[0m02:56:53.079910 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1367ae9d0>]}
[0m02:56:53.080575 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 14.80s]
[0m02:56:53.081069 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m02:56:53.082030 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m02:56:53.082553 [info ] [Thread-3  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m02:56:53.083437 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m02:56:53.083724 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m02:56:53.090199 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m02:56:53.091338 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 02:56:53.083919 => 2023-02-07 02:56:53.091225
[0m02:56:53.091731 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m02:56:53.102308 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m02:56:53.102750 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:56:53.102929 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m02:56:54.230809 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:c5992548-209e-4219-9e3d-28c67bd0577f&page=queryresults
[0m02:56:54.233569 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 02:56:53.091951 => 2023-02-07 02:56:54.233491
[0m02:56:54.234473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'effa6c2c-734d-42a3-8f85-9519966d4538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368e57c0>]}
[0m02:56:54.234978 [info ] [Thread-3  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m02:56:54.235405 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m02:56:54.237093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:54.237744 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m02:56:54.238199 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m02:56:54.238633 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m02:56:54.239247 [info ] [MainThread]: 
[0m02:56:54.240075 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 19.37 seconds (19.37s).
[0m02:56:54.240915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1364754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13674f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13674f250>]}
[0m02:56:54.241451 [debug] [MainThread]: Flushing usage events
[0m02:56:54.810855 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m02:56:54.813656 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 10:11:20.835170 | 43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd ==============================
[0m10:11:20.835170 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:11:20.836795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:11:20.836940 [debug] [MainThread]: Tracking: tracking
[0m10:11:20.853644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343c6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343b8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343b8a60>]}
[0m10:11:20.903335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:20.903694 [debug] [MainThread]: Partial parsing: updated file: google_analytics_dbt://models/google_analytics/schema.yml
[0m10:11:20.912691 [debug] [MainThread]: 1699: static parser successfully parsed google_analytics/distinct_country_count.sql
[0m10:11:20.935417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m10:11:20.938655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134635f10>]}
[0m10:11:20.943612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344da4f0>]}
[0m10:11:20.943807 [info ] [MainThread]: Found 6 models, 3 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:11:20.943940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344da670>]}
[0m10:11:20.944766 [info ] [MainThread]: 
[0m10:11:20.945670 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:11:20.946368 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:11:20.946693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:11:20.946847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:20.946971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:22.672585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m10:11:22.674296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m10:11:22.674999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:22.675467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:23.174559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344da670>]}
[0m10:11:23.175860 [info ] [MainThread]: 
[0m10:11:23.176519 [info ] [MainThread]: Running 3 on-run-start hooks
[0m10:11:23.200823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:23.662482 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m10:11:23.668607 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m10:11:23.669401 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m10:11:23.999894 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m10:11:24.001707 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m10:11:24.002365 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m10:11:24.023572 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m10:11:24.024779 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m10:11:24.025430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd'
    );



[0m10:11:24.411496 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:e18c43ed-ec0d-4a88-aa4f-d254db649fd8&page=queryresults
[0m10:11:24.412913 [info ] [MainThread]: Database error while running on-run-start
[0m10:11:24.414667 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m10:11:24.415356 [info ] [MainThread]: 
[0m10:11:24.422957 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m10:11:24.423380 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m10:11:24.423735 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_audit_log
[0m10:11:24.424186 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m10:11:24.424772 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m10:11:24.425319 [info ] [Thread-3  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m10:11:24.426281 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m10:11:24.426986 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m10:11:24.427693 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m10:11:24.428007 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m10:11:24.428455 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m10:11:24.428699 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m10:11:24.433006 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m10:11:24.436982 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m10:11:24.454758 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m10:11:24.455806 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 10:11:24.428888 => 2023-02-07 10:11:24.455725
[0m10:11:24.456042 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 10:11:24.433246 => 2023-02-07 10:11:24.456001
[0m10:11:24.456233 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m10:11:24.456467 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m10:11:24.456625 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 10:11:24.437198 => 2023-02-07 10:11:24.456591
[0m10:11:24.469554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:24.471151 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:11:24.471325 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_audit_log
[0m10:11:24.490548 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m10:11:24.491298 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:11:24.491444 [debug] [Thread-3  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m10:11:24.996284 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m10:11:24.997896 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m10:11:24.998683 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      



SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:11:24.998928 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:11:25.581824 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:b0405d90-5719-41ed-92bd-d32e8696e2bb&page=queryresults
[0m10:11:25.607235 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 10:11:24.472601 => 2023-02-07 10:11:25.607157
[0m10:11:25.608115 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346e77f0>]}
[0m10:11:25.608540 [info ] [Thread-3  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m10:11:25.609947 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_audit_log
[0m10:11:25.610470 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_deployments
[0m10:11:25.610743 [info ] [Thread-3  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m10:11:25.611317 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m10:11:25.611522 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_deployments
[0m10:11:25.620397 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m10:11:25.620999 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 10:11:25.611658 => 2023-02-07 10:11:25.620954
[0m10:11:25.621187 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_deployments
[0m10:11:25.624250 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m10:11:25.624671 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:11:25.624936 [debug] [Thread-3  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m10:11:26.866786 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:f72b8b73-1778-4808-bb1d-adbef617522c&page=queryresults
[0m10:11:26.871602 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 10:11:25.621323 => 2023-02-07 10:11:26.871462
[0m10:11:26.873142 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346e77f0>]}
[0m10:11:26.873974 [info ] [Thread-3  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m10:11:26.874479 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_deployments
[0m10:11:26.874885 [debug] [Thread-3  ]: Began running node model.logging.stg_dbt_model_deployments
[0m10:11:26.875236 [info ] [Thread-3  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m10:11:26.876149 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m10:11:26.876512 [debug] [Thread-3  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m10:11:26.885043 [debug] [Thread-3  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m10:11:26.885803 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 10:11:26.876732 => 2023-02-07 10:11:26.885738
[0m10:11:26.886072 [debug] [Thread-3  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m10:11:26.890061 [debug] [Thread-3  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m10:11:26.890630 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:11:26.890970 [debug] [Thread-3  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m10:11:28.143175 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:39c8e9f2-3516-4ef0-ae0e-7456a66704ed&page=queryresults
[0m10:11:28.148186 [debug] [Thread-3  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 10:11:26.886235 => 2023-02-07 10:11:28.148080
[0m10:11:28.149529 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13526cf40>]}
[0m10:11:28.150129 [info ] [Thread-3  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m10:11:28.150599 [debug] [Thread-3  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m10:11:40.375747 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:fc03633d-6f39-49fb-a9ae-f936cb1a3bda&page=queryresults
[0m10:11:40.381392 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 10:11:24.469686 => 2023-02-07 10:11:40.381276
[0m10:11:40.382947 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346e7730>]}
[0m10:11:40.383585 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.96s]
[0m10:11:40.384075 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m10:11:42.327220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4426736f-4a72-4836-b8e9-5d2dd46c2ac7&page=queryresults
[0m10:11:42.331463 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 10:11:24.456763 => 2023-02-07 10:11:42.331341
[0m10:11:42.332869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346c81f0>]}
[0m10:11:42.333610 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 17.91s]
[0m10:11:42.334079 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m10:11:42.335589 [debug] [Thread-3  ]: Began running node model.google_analytics_dbt.users_report
[0m10:11:42.336417 [info ] [Thread-3  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m10:11:42.337437 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m10:11:42.337762 [debug] [Thread-3  ]: Began compiling node model.google_analytics_dbt.users_report
[0m10:11:42.346164 [debug] [Thread-3  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m10:11:42.347281 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 10:11:42.337980 => 2023-02-07 10:11:42.347212
[0m10:11:42.347546 [debug] [Thread-3  ]: Began executing node model.google_analytics_dbt.users_report
[0m10:11:42.353694 [debug] [Thread-3  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m10:11:42.354291 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:11:42.354656 [debug] [Thread-3  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m10:11:43.662283 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:8ea8860d-21b5-45d5-b00d-14cb1a2f1faa&page=queryresults
[0m10:11:43.665992 [debug] [Thread-3  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 10:11:42.347724 => 2023-02-07 10:11:43.665897
[0m10:11:43.667279 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f692ad-bf6d-44c2-8fce-f7cb4bc89bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347d4b50>]}
[0m10:11:43.667944 [info ] [Thread-3  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m10:11:43.668435 [debug] [Thread-3  ]: Finished running node model.google_analytics_dbt.users_report
[0m10:11:43.670046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:43.670560 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m10:11:43.670891 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m10:11:43.671242 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m10:11:43.671814 [info ] [MainThread]: 
[0m10:11:43.672343 [info ] [MainThread]: Finished running 4 view models, 2 table models, 2 hooks in 0 hours 0 minutes and 22.73 seconds (22.73s).
[0m10:11:43.673154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344da280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346e5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346eedc0>]}
[0m10:11:43.673682 [debug] [MainThread]: Flushing usage events
[0m10:11:44.333255 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m10:11:44.336623 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 10:18:34.608586 | 0e6e4db4-0688-49a7-9bc5-121e6f3a80bf ==============================
[0m10:18:34.608586 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:18:34.610468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'threads': 2, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:18:34.610632 [debug] [MainThread]: Tracking: tracking
[0m10:18:34.622004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130098130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130069f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130069220>]}
[0m10:18:34.673767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:34.673968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:34.674409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m10:18:34.677801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302bc0d0>]}
[0m10:18:34.682749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130195820>]}
[0m10:18:34.682937 [info ] [MainThread]: Found 6 models, 3 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:18:34.683076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130085c40>]}
[0m10:18:34.683950 [info ] [MainThread]: 
[0m10:18:34.684792 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:18:34.685505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:18:34.685858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:18:34.685979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:34.686106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:36.316626 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m10:18:36.317874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m10:18:36.318580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:36.318938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:36.729517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301956a0>]}
[0m10:18:36.730406 [info ] [MainThread]: 
[0m10:18:36.730880 [info ] [MainThread]: Running 3 on-run-start hooks
[0m10:18:36.746913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:37.235481 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m10:18:37.241474 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m10:18:37.242299 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m10:18:37.644674 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m10:18:37.646642 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m10:18:37.647326 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m10:18:37.673707 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m10:18:37.674558 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m10:18:37.675107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf'
    );



[0m10:18:38.158262 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:76664817-6238-4fdc-a9f3-b33e3c827ced&page=queryresults
[0m10:18:38.159768 [info ] [MainThread]: Database error while running on-run-start
[0m10:18:38.161031 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:18:38.161363 [info ] [MainThread]: 
[0m10:18:38.170692 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m10:18:38.171084 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m10:18:38.171606 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m10:18:38.172084 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m10:18:38.172908 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m10:18:38.173463 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m10:18:38.173709 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m10:18:38.173952 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m10:18:38.178275 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m10:18:38.182123 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m10:18:38.183184 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 10:18:38.174129 => 2023-02-07 10:18:38.183089
[0m10:18:38.183423 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 10:18:38.178505 => 2023-02-07 10:18:38.183375
[0m10:18:38.183643 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m10:18:38.183858 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m10:18:38.200073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:38.202312 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:18:38.624046 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m10:18:38.624818 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      



SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:18:38.709579 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m10:18:38.710918 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:18:52.800630 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:cd3ac2c1-6f77-4f82-a099-9e7cb88cd1a9&page=queryresults
[0m10:18:52.839263 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 10:18:38.184005 => 2023-02-07 10:18:52.839183
[0m10:18:52.840179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302df160>]}
[0m10:18:52.840662 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 14.67s]
[0m10:18:52.844226 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m10:18:52.844650 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_audit_log
[0m10:18:52.845171 [info ] [Thread-1  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m10:18:52.845957 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m10:18:52.846231 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m10:18:52.861797 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m10:18:52.862538 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 10:18:52.846396 => 2023-02-07 10:18:52.862488
[0m10:18:52.862712 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_audit_log
[0m10:18:52.878203 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m10:18:52.878739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:52.878956 [debug] [Thread-1  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m10:18:53.535741 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:4dede8fa-efb2-4cdc-b816-08dfb9fcefec&page=queryresults
[0m10:18:53.538364 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 10:18:38.200324 => 2023-02-07 10:18:53.538290
[0m10:18:53.539625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302edb50>]}
[0m10:18:53.540605 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.37s]
[0m10:18:53.542065 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m10:18:53.542781 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.users_report
[0m10:18:53.543234 [info ] [Thread-2  ]: 4 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m10:18:53.544183 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m10:18:53.544503 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.users_report
[0m10:18:53.550779 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m10:18:53.552264 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 10:18:53.544707 => 2023-02-07 10:18:53.552166
[0m10:18:53.552640 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.users_report
[0m10:18:53.559088 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m10:18:53.560182 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:18:53.560680 [debug] [Thread-2  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m10:18:54.211826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:9c001629-61f8-4fb7-9b80-d3d86453d950&page=queryresults
[0m10:18:54.215482 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 10:18:52.862822 => 2023-02-07 10:18:54.215399
[0m10:18:54.216737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302dfcd0>]}
[0m10:18:54.217448 [info ] [Thread-1  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m10:18:54.217889 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_audit_log
[0m10:18:54.218515 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m10:18:54.218929 [info ] [Thread-1  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m10:18:54.219720 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m10:18:54.219997 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m10:18:54.231946 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m10:18:54.232775 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 10:18:54.220178 => 2023-02-07 10:18:54.232700
[0m10:18:54.233087 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m10:18:54.238274 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m10:18:54.238823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:54.239157 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m10:18:54.847587 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:75607a1c-2682-4b1b-9444-b9617a74edec&page=queryresults
[0m10:18:54.869684 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 10:18:53.552880 => 2023-02-07 10:18:54.869572
[0m10:18:54.871305 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130743ca0>]}
[0m10:18:54.872130 [info ] [Thread-2  ]: 4 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m10:18:54.873008 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.users_report
[0m10:18:54.873786 [debug] [Thread-2  ]: Began running node model.logging.stg_dbt_model_deployments
[0m10:18:54.874411 [info ] [Thread-2  ]: 6 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m10:18:54.875967 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m10:18:54.876532 [debug] [Thread-2  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m10:18:54.888717 [debug] [Thread-2  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m10:18:54.889890 [debug] [Thread-2  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 10:18:54.876753 => 2023-02-07 10:18:54.889765
[0m10:18:54.890260 [debug] [Thread-2  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m10:18:54.895064 [debug] [Thread-2  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m10:18:54.895821 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:18:54.896158 [debug] [Thread-2  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m10:18:55.426704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:a1008643-b9cc-490d-8a9a-d9bbd1d66ba7&page=queryresults
[0m10:18:55.430978 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 10:18:54.233274 => 2023-02-07 10:18:55.430871
[0m10:18:55.432384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303bf730>]}
[0m10:18:55.433187 [info ] [Thread-1  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m10:18:55.433820 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m10:18:56.001497 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:27e16be4-214c-4a50-986d-03a50445abda&page=queryresults
[0m10:18:56.008982 [debug] [Thread-2  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 10:18:54.890474 => 2023-02-07 10:18:56.008656
[0m10:18:56.010894 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6e4db4-0688-49a7-9bc5-121e6f3a80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130743ee0>]}
[0m10:18:56.011873 [info ] [Thread-2  ]: 6 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m10:18:56.012660 [debug] [Thread-2  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m10:18:56.014655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:56.015307 [debug] [MainThread]: Connection 'model.logging.stg_dbt_deployments' was properly closed.
[0m10:18:56.015655 [debug] [MainThread]: Connection 'model.logging.stg_dbt_model_deployments' was properly closed.
[0m10:18:56.016240 [info ] [MainThread]: 
[0m10:18:56.016952 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 21.33 seconds (21.33s).
[0m10:18:56.017815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302e8f10>]}
[0m10:18:56.018530 [debug] [MainThread]: Flushing usage events
[0m10:18:56.638336 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m10:18:56.643229 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 10:24:40.781286 | 64295da5-9e59-4774-90c6-c9a62859befb ==============================
[0m10:24:40.781286 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:24:40.782924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'threads': 2, 'select': ['google_analytics_sample.distinct_country_count', 'google_analytics_sample.total_page_views'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:24:40.783072 [debug] [MainThread]: Tracking: tracking
[0m10:24:40.793861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11faf2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fae6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fae6b80>]}
[0m10:24:40.841004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:40.841199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:40.841639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m10:24:40.844988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64295da5-9e59-4774-90c6-c9a62859befb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd270d0>]}
[0m10:24:40.850055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64295da5-9e59-4774-90c6-c9a62859befb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc08670>]}
[0m10:24:40.850246 [info ] [MainThread]: Found 6 models, 3 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:24:40.850381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64295da5-9e59-4774-90c6-c9a62859befb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc08850>]}
[0m10:24:40.850758 [warn ] [MainThread]: The selection criterion 'google_analytics_sample.distinct_country_count' does not match any nodes
[0m10:24:40.850967 [warn ] [MainThread]: The selection criterion 'google_analytics_sample.total_page_views' does not match any nodes
[0m10:24:40.851444 [info ] [MainThread]: 
[0m10:24:40.851619 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:40.851755 [debug] [MainThread]: Command end result
[0m10:24:40.855734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc08400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc081c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc083d0>]}
[0m10:24:40.855876 [debug] [MainThread]: Flushing usage events


============================== 2023-02-07 10:25:27.065775 | 92430677-b9d9-438e-bd8b-317492d8e4ef ==============================
[0m10:25:27.065775 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:25:27.067116 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'threads': 2, 'select': ['distinct_country_count', 'total_page_views'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:25:27.067224 [debug] [MainThread]: Tracking: tracking
[0m10:25:27.078099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146005a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457f8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457f8bb0>]}
[0m10:25:27.122805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:25:27.123036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:25:27.123497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m10:25:27.126909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14623b0d0>]}
[0m10:25:27.131945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146116700>]}
[0m10:25:27.132139 [info ] [MainThread]: Found 6 models, 3 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:25:27.132274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146116880>]}
[0m10:25:27.133074 [info ] [MainThread]: 
[0m10:25:27.133913 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:25:27.134527 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:25:27.134696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:28.410896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m10:25:28.412465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m10:25:28.413186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:28.413674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:28.891913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146116400>]}
[0m10:25:28.893503 [info ] [MainThread]: 
[0m10:25:28.894147 [info ] [MainThread]: Running 3 on-run-start hooks
[0m10:25:28.912571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:29.393777 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m10:25:29.399771 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m10:25:29.400673 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m10:25:29.802804 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m10:25:29.804650 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m10:25:29.805434 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m10:25:29.826767 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m10:25:29.827978 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m10:25:29.828663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '92430677-b9d9-438e-bd8b-317492d8e4ef'
    );



[0m10:25:30.214128 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:3270675c-f223-4677-ac8a-0f1fe9409051&page=queryresults
[0m10:25:30.215358 [info ] [MainThread]: Database error while running on-run-start
[0m10:25:30.216922 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:25:30.217280 [info ] [MainThread]: 
[0m10:25:30.229185 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m10:25:30.229640 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m10:25:30.230118 [info ] [Thread-1  ]: 1 of 2 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m10:25:30.230568 [info ] [Thread-2  ]: 2 of 2 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m10:25:30.231437 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m10:25:30.232089 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m10:25:30.232369 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m10:25:30.232624 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m10:25:30.237918 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m10:25:30.241797 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m10:25:30.243143 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 10:25:30.232839 => 2023-02-07 10:25:30.243033
[0m10:25:30.243385 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m10:25:30.243571 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 10:25:30.238187 => 2023-02-07 10:25:30.243527
[0m10:25:30.259652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:30.259957 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m10:25:30.262629 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:25:30.758810 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m10:25:30.759609 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:25:30.764211 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m10:25:30.764713 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      



SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:25:46.083080 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:89069689-9dec-4231-b2ed-2af69a7a0cb4&page=queryresults
[0m10:25:46.113054 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 10:25:30.260808 => 2023-02-07 10:25:46.112971
[0m10:25:46.114037 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462922e0>]}
[0m10:25:46.114580 [info ] [Thread-2  ]: 2 of 2 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 15.88s]
[0m10:25:46.116270 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m10:25:48.116938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:11e09d91-1cd0-441f-98a9-e252f2745e86&page=queryresults
[0m10:25:48.122621 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 10:25:30.243702 => 2023-02-07 10:25:48.122448
[0m10:25:48.124099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92430677-b9d9-438e-bd8b-317492d8e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462a5190>]}
[0m10:25:48.124763 [info ] [Thread-1  ]: 1 of 2 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 17.89s]
[0m10:25:48.125249 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m10:25:48.126480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:48.126793 [debug] [MainThread]: Connection 'model.google_analytics_dbt.distinct_country_count' was properly closed.
[0m10:25:48.127016 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m10:25:48.127299 [info ] [MainThread]: 
[0m10:25:48.127630 [info ] [MainThread]: Finished running 2 table models, 2 hooks in 0 hours 0 minutes and 20.99 seconds (20.99s).
[0m10:25:48.128117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146293190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462cc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462cc1c0>]}
[0m10:25:48.128455 [debug] [MainThread]: Flushing usage events
[0m10:25:48.688408 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m10:25:48.693433 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'



============================== 2023-02-07 10:35:07.398926 | 6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b ==============================
[0m10:35:07.398926 [info ] [MainThread]: Running with dbt=1.4.1
[0m10:35:07.400445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ismailaffaf/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'threads': 2, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:35:07.400572 [debug] [MainThread]: Tracking: tracking
[0m10:35:07.411910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122345a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122339940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122339a90>]}
[0m10:35:07.460566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:07.460807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:07.461292 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.google_analytics.example
[0m10:35:07.464636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12257b0d0>]}
[0m10:35:07.469788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122456670>]}
[0m10:35:07.469989 [info ] [MainThread]: Found 6 models, 3 tests, 0 snapshots, 4 analyses, 461 macros, 4 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:35:07.470125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122456880>]}
[0m10:35:07.470962 [info ] [MainThread]: 
[0m10:35:07.471794 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:35:07.472516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:35:07.472852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902'
[0m10:35:07.472996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:07.473119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:09.503189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample'
[0m10:35:09.505105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_wo-dev-376902_google_analytics_sample_meta'
[0m10:35:09.506014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:09.506411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:09.971160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12237fd60>]}
[0m10:35:09.972534 [info ] [MainThread]: 
[0m10:35:09.973211 [info ] [MainThread]: Running 3 on-run-start hooks
[0m10:35:09.990626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:10.521334 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-0"
[0m10:35:10.527145 [info ] [MainThread]: 1 of 3 START hook: logging.on-run-start.0 ...................................... [RUN]
[0m10:35:10.527803 [info ] [MainThread]: 1 of 3 OK hook: logging.on-run-start.0 ......................................... [[32mOK[0m in 0.00s]
[0m10:35:10.932420 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-1"
[0m10:35:10.934118 [info ] [MainThread]: 2 of 3 START hook: logging.on-run-start.1 ...................................... [RUN]
[0m10:35:10.934993 [info ] [MainThread]: 2 of 3 OK hook: logging.on-run-start.1 ......................................... [[32mOK[0m in 0.00s]
[0m10:35:10.961467 [debug] [MainThread]: Writing injected SQL for node "operation.logging.logging-on-run-start-2"
[0m10:35:10.962635 [info ] [MainThread]: 3 of 3 START hook: logging.on-run-start.2 ...................................... [RUN]
[0m10:35:10.963234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "connection_name": "master"} */

    

    insert into `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log` (
        event_name,
        event_timestamp,
        event_schema,
        event_model,
        event_target,
        event_is_full_refresh,
        invocation_id
    )

    values (
        'run started',
        current_timestamp,
        '',
        '',
        'dev',
        FALSE,
        '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b'
    );



[0m10:35:11.273213 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:26e3ef82-dbf7-4186-9572-109ca6e985e2&page=queryresults
[0m10:35:11.274660 [info ] [MainThread]: Database error while running on-run-start
[0m10:35:11.276265 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:35:11.276951 [info ] [MainThread]: 
[0m10:35:11.285737 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.distinct_country_count
[0m10:35:11.286141 [debug] [Thread-2  ]: Began running node model.google_analytics_dbt.total_page_views
[0m10:35:11.286691 [info ] [Thread-1  ]: 1 of 6 START sql table model google_analytics_sample.distinct_country_count .... [RUN]
[0m10:35:11.287192 [info ] [Thread-2  ]: 2 of 6 START sql table model google_analytics_sample.total_page_views .......... [RUN]
[0m10:35:11.288068 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.distinct_country_count'
[0m10:35:11.288747 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.total_page_views'
[0m10:35:11.289052 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.distinct_country_count
[0m10:35:11.289328 [debug] [Thread-2  ]: Began compiling node model.google_analytics_dbt.total_page_views
[0m10:35:11.293686 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.distinct_country_count"
[0m10:35:11.297481 [debug] [Thread-2  ]: Writing injected SQL for node "model.google_analytics_dbt.total_page_views"
[0m10:35:11.298887 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (compile): 2023-02-07 10:35:11.289550 => 2023-02-07 10:35:11.298783
[0m10:35:11.299129 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (compile): 2023-02-07 10:35:11.293913 => 2023-02-07 10:35:11.299076
[0m10:35:11.299359 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.distinct_country_count
[0m10:35:11.299587 [debug] [Thread-2  ]: Began executing node model.google_analytics_dbt.total_page_views
[0m10:35:11.315885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:35:11.318087 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:35:11.903162 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.distinct_country_count"
[0m10:35:11.903595 [debug] [Thread-2  ]: Writing runtime sql for node "model.google_analytics_dbt.total_page_views"
[0m10:35:11.904217 [debug] [Thread-2  ]: On model.google_analytics_dbt.total_page_views: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.total_page_views"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`total_page_views`
    
    
    OPTIONS()
    as (
      



SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    SUM(totals.pageviews) AS totalPageViews,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:35:11.904418 [debug] [Thread-1  ]: On model.google_analytics_dbt.distinct_country_count: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.distinct_country_count"} */

  
    

    create or replace table `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count`
    
    
    OPTIONS()
    as (
      

SELECT 
    date AS reportDate, 
    device.operatingSystem AS operationSystem,
    COUNT(DISTINCT geoNetwork.country) AS distincCountCountry,
FROM `bigquery-public-data`.`google_analytics_sample`.`ga_sessions_*`
GROUP BY date, device.operatingSystem
    );
  
[0m10:35:26.069879 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:675429a4-8fa3-4c54-92de-88f15e2a7bdf&page=queryresults
[0m10:35:26.098769 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.distinct_country_count (execute): 2023-02-07 10:35:11.299728 => 2023-02-07 10:35:26.098698
[0m10:35:26.099593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226727c0>]}
[0m10:35:26.100033 [info ] [Thread-1  ]: 1 of 6 OK created sql table model google_analytics_sample.distinct_country_count  [[32mCREATE TABLE (3.5k rows, 26.6 MB processed)[0m in 14.81s]
[0m10:35:26.101508 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.distinct_country_count
[0m10:35:26.101837 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_audit_log
[0m10:35:26.102262 [info ] [Thread-1  ]: 3 of 6 START sql view model google_analytics_sample_meta.stg_dbt_audit_log ..... [RUN]
[0m10:35:26.102940 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_audit_log'
[0m10:35:26.103177 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_audit_log
[0m10:35:26.119231 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_audit_log"
[0m10:35:26.119916 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_audit_log (compile): 2023-02-07 10:35:26.103326 => 2023-02-07 10:35:26.119864
[0m10:35:26.120111 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_audit_log
[0m10:35:26.135648 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_audit_log"
[0m10:35:26.136036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:35:26.136239 [debug] [Thread-1  ]: On model.logging.stg_dbt_audit_log: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_audit_log"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`
  OPTIONS()
  as with audit as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`dbt_audit_log`

),

with_id as (

    select

        *,

        
    
to_hex(md5(cast(coalesce(cast(event_name as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as event_id

    from audit

)

select * from with_id;


[0m10:35:27.622979 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:724f1c73-86f6-41c5-b830-b84771364cea&page=queryresults
[0m10:35:27.627055 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_audit_log (execute): 2023-02-07 10:35:26.120226 => 2023-02-07 10:35:27.626949
[0m10:35:27.628348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122672ca0>]}
[0m10:35:27.628873 [info ] [Thread-1  ]: 3 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_audit_log  [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m10:35:27.629272 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_audit_log
[0m10:35:27.629828 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_deployments
[0m10:35:27.630136 [info ] [Thread-1  ]: 4 of 6 START sql view model google_analytics_sample_meta.stg_dbt_deployments ... [RUN]
[0m10:35:27.630794 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_deployments'
[0m10:35:27.631028 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_deployments
[0m10:35:27.643777 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_deployments"
[0m10:35:27.644515 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (compile): 2023-02-07 10:35:27.631214 => 2023-02-07 10:35:27.644454
[0m10:35:27.644778 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_deployments
[0m10:35:27.648934 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_deployments"
[0m10:35:27.649478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:35:27.649811 [debug] [Thread-1  ]: On model.logging.stg_dbt_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        invocation_id,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'run started' then event_timestamp
            end) as deployment_started_at,

        min(case
            when event_name = 'run completed' then event_timestamp
            end) as deployment_completed_at,

        count(distinct case
            when event_name like '%model%' then event_model
            end) as models_deployed

    from events

    group by 1,2,3

)

select * from aggregated;


[0m10:35:28.868635 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:a1da462f-0dc3-4df1-a7a0-73dce8b0def9&page=queryresults
[0m10:35:28.873615 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_deployments (execute): 2023-02-07 10:35:27.644944 => 2023-02-07 10:35:28.873500
[0m10:35:28.874933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225ea4f0>]}
[0m10:35:28.875555 [info ] [Thread-1  ]: 4 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m10:35:28.876030 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_deployments
[0m10:35:28.876424 [debug] [Thread-1  ]: Began running node model.logging.stg_dbt_model_deployments
[0m10:35:28.876930 [info ] [Thread-1  ]: 5 of 6 START sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [RUN]
[0m10:35:28.877843 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.logging.stg_dbt_model_deployments'
[0m10:35:28.878178 [debug] [Thread-1  ]: Began compiling node model.logging.stg_dbt_model_deployments
[0m10:35:28.889972 [debug] [Thread-1  ]: Writing injected SQL for node "model.logging.stg_dbt_model_deployments"
[0m10:35:28.891494 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_model_deployments (compile): 2023-02-07 10:35:28.878392 => 2023-02-07 10:35:28.891436
[0m10:35:28.891750 [debug] [Thread-1  ]: Began executing node model.logging.stg_dbt_model_deployments
[0m10:35:28.895781 [debug] [Thread-1  ]: Writing runtime sql for node "model.logging.stg_dbt_model_deployments"
[0m10:35:28.896323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:35:28.896648 [debug] [Thread-1  ]: On model.logging.stg_dbt_model_deployments: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.logging.stg_dbt_model_deployments"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_model_deployments`
  OPTIONS()
  as with events as (

    select * from `wo-dev-376902`.`google_analytics_sample_meta`.`stg_dbt_audit_log`

),

aggregated as (

    select

        
    
to_hex(md5(cast(coalesce(cast(event_model as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invocation_id as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as model_deployment_id,

        invocation_id,
        event_model as model,
        event_schema as schema,
        event_target as target,
        event_is_full_refresh as is_full_refresh,

        min(case
            when event_name = 'model deployment started' then event_timestamp
        end) as deployment_started_at,

        min(case
            when event_name = 'model deployment completed' then event_timestamp
        end) as deployment_completed_at

    from events

    where event_name like '%model%'

    group by 1,2,3,4,5,6

)

select * from aggregated;


[0m10:35:30.185757 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:25e7b80d-27fc-4468-9a43-dc89aebdb035&page=queryresults
[0m10:35:30.191464 [debug] [Thread-1  ]: Timing info for model.logging.stg_dbt_model_deployments (execute): 2023-02-07 10:35:28.891924 => 2023-02-07 10:35:30.191379
[0m10:35:30.192472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12295c4c0>]}
[0m10:35:30.193201 [info ] [Thread-1  ]: 5 of 6 OK created sql view model google_analytics_sample_meta.stg_dbt_model_deployments  [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m10:35:30.193969 [debug] [Thread-1  ]: Finished running node model.logging.stg_dbt_model_deployments
[0m10:35:30.591369 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:2f467843-0642-46bf-9c01-1c03b76a603e&page=queryresults
[0m10:35:30.595791 [debug] [Thread-2  ]: Timing info for model.google_analytics_dbt.total_page_views (execute): 2023-02-07 10:35:11.316134 => 2023-02-07 10:35:30.595629
[0m10:35:30.597255 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225ac610>]}
[0m10:35:30.598033 [info ] [Thread-2  ]: 2 of 6 OK created sql table model google_analytics_sample.total_page_views ..... [[32mCREATE TABLE (3.5k rows, 23.3 MB processed)[0m in 19.31s]
[0m10:35:30.598530 [debug] [Thread-2  ]: Finished running node model.google_analytics_dbt.total_page_views
[0m10:35:30.599912 [debug] [Thread-1  ]: Began running node model.google_analytics_dbt.users_report
[0m10:35:30.600380 [info ] [Thread-1  ]: 6 of 6 START sql view model google_analytics_sample.users_report ............... [RUN]
[0m10:35:30.601174 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.google_analytics_dbt.users_report'
[0m10:35:30.601468 [debug] [Thread-1  ]: Began compiling node model.google_analytics_dbt.users_report
[0m10:35:30.606622 [debug] [Thread-1  ]: Writing injected SQL for node "model.google_analytics_dbt.users_report"
[0m10:35:30.607375 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.users_report (compile): 2023-02-07 10:35:30.601663 => 2023-02-07 10:35:30.607308
[0m10:35:30.607688 [debug] [Thread-1  ]: Began executing node model.google_analytics_dbt.users_report
[0m10:35:30.611783 [debug] [Thread-1  ]: Writing runtime sql for node "model.google_analytics_dbt.users_report"
[0m10:35:30.612308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:35:30.612630 [debug] [Thread-1  ]: On model.google_analytics_dbt.users_report: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "google_analytics_dbt", "target_name": "dev", "node_id": "model.google_analytics_dbt.users_report"} */


  create or replace view `wo-dev-376902`.`google_analytics_sample`.`users_report`
  OPTIONS()
  as 

SELECT 
    c.reportDate,
    c.operationSystem,
    c.distincCountCountry,
    t.totalPageViews
FROM `wo-dev-376902`.`google_analytics_sample`.`distinct_country_count` AS c
JOIN `wo-dev-376902`.`google_analytics_sample`.`total_page_views` AS t
ON c.reportDate = t.reportDate AND c.operationSystem = t.operationSystem;


[0m10:35:31.925068 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wo-dev-376902&j=bq:US:de0dfe30-fbcc-4974-be14-29e52cf59cd6&page=queryresults
[0m10:35:31.929339 [debug] [Thread-1  ]: Timing info for model.google_analytics_dbt.users_report (execute): 2023-02-07 10:35:30.607883 => 2023-02-07 10:35:31.929223
[0m10:35:31.930727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b21efbc-34b1-4a1d-bc5d-c37a332ecc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12264b790>]}
[0m10:35:31.931342 [info ] [Thread-1  ]: 6 of 6 OK created sql view model google_analytics_sample.users_report .......... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m10:35:31.931804 [debug] [Thread-1  ]: Finished running node model.google_analytics_dbt.users_report
[0m10:35:31.932923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:31.933179 [debug] [MainThread]: Connection 'model.google_analytics_dbt.users_report' was properly closed.
[0m10:35:31.933385 [debug] [MainThread]: Connection 'model.google_analytics_dbt.total_page_views' was properly closed.
[0m10:35:31.933705 [info ] [MainThread]: 
[0m10:35:31.934043 [info ] [MainThread]: Finished running 2 table models, 4 view models, 2 hooks in 0 hours 0 minutes and 24.46 seconds (24.46s).
[0m10:35:31.934502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122339a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225ae040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225ae790>]}
[0m10:35:31.934842 [debug] [MainThread]: Flushing usage events
[0m10:35:32.626744 [error] [MainThread]: Encountered an error:
'BaseResult' object has no attribute 'node'
[0m10:35:32.631593 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 436, in execute_with_hooks
    self.after_run(adapter, res)
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 443, in after_run
    database_schema_set: Set[Tuple[Optional[str], str]] = {
  File "/opt/homebrew/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 446, in <setcomp>
    if r.node.is_relational
AttributeError: 'BaseResult' object has no attribute 'node'

